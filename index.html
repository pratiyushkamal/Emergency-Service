<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Find local emergency services including hospitals, fire departments, shelters, and crisis hotlines anywhere in the world. Fast, reliable, and accessible.">
    <meta name="keywords" content="emergency services, global hospitals, fire department, crisis hotline, shelters, emergency directory, pharmacies, veterinary, community support">
    <meta name="author" content="Global Emergency Services Directory">
    <meta name="robots" content="index, follow">
    <meta property="og:title" content="Global Emergency Services Finder">
    <meta property="og:description" content="Quickly locate emergency services like hospitals, fire stations, and crisis hotlines anywhere in the world.">
    <meta property="og:type" content="website">
    <meta property="og:url" content="https://yourwebsite.com">
    <meta property="og:image" content="https://yourwebsite.com/images/og-image.jpg">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" integrity="sha512-iecdLmaskl7CVkqkXNQ/ZH/XLlvWZOJyj7Yy7tcenmpD1ypASozpmT/E0iPtmFIB46ZmdtAc9eNBvH0H/ZpiBw==" crossorigin="anonymous" referrerpolicy="no-referrer" />
    <link href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&family=Open+Sans:wght@400;600;700&display=swap" rel="stylesheet">
    
    <title>Global Emergency Services Finder | Help When You Need It</title>
    <script async src="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js?client=ca-pub-6066867577696178" crossorigin="anonymous"></script>

    <style>
        /* EmergencyFinderWebsite/style.css */

        :root {
            --primary: #2563eb; /* Blue */
            --primary-dark: #1d4ed8; /* Darker Blue */
            --secondary: #e11d48; /* Red */
            --secondary-dark: #be123c; /* Darker Red */
            --dark: #1e293b; /* Dark Slate */
            --light: #f8fafc; /* Off-white */
            --gray: #94a3b8; /* Medium Gray */
            --success: #10b981; /* Green */
            --warning: #f59e0b; /* Amber */
            --danger: #ef4444; /* Red */
            --info: #0ea5e9; /* Light Blue */
            --background-light: #f0f5ff; /* Very light blue for sections */
            --text-light: #fefefe; /* Near white for text on dark backgrounds */
        }

        /* Base Styles */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Open Sans', sans-serif;
            line-height: 1.6;
            color: var(--dark);
            background-color: var(--light);
            -webkit-font-smoothing: antialiased;
            -moz-osx-font-smoothing: grayscale;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 0 20px;
        }

        /* Header */
        header {
            background: linear-gradient(135deg, var(--primary), var(--primary-dark));
            color: var(--text-light);
            padding: 1rem 0;
            box-shadow: 0 6px 12px rgba(0, 0, 0, 0.15);
            position: sticky;
            top: 0;
            z-index: 100;
            border-bottom-left-radius: 8px;
            border-bottom-right-radius: 8px;
        }

        .header-content {
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        .logo {
            display: flex;
            align-items: center;
            gap: 10px;
            text-decoration: none; /* Ensure logo link doesn't have underline */
            color: var(--text-light);
        }

        .logo i {
            font-size: 2.2rem;
            color: #fff;
            transition: transform 0.3s ease;
        }

        .logo:hover i {
            transform: rotate(-5deg);
        }

        header h1 {
            font-family: 'Poppins', sans-serif;
            font-size: 1.9rem;
            font-weight: 600;
            letter-spacing: -0.5px;
        }

        header h1 span {
            font-weight: 300;
            opacity: 0.9;
        }

        nav ul {
            list-style: none;
            display: flex;
            gap: 1.8rem;
        }

        nav a {
            color: var(--text-light);
            text-decoration: none;
            font-weight: 600;
            padding: 0.6rem 1.1rem;
            border-radius: 6px;
            transition: all 0.3s ease;
            position: relative;
            overflow: hidden;
        }

        nav a::before {
            content: '';
            position: absolute;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 3px;
            background-color: var(--secondary);
            transform: translateX(-100%);
            transition: transform 0.3s ease-out;
        }

        nav a:hover::before, nav a:focus::before {
            transform: translateX(0);
        }

        nav a:hover, nav a:focus {
            background-color: rgba(255, 255, 255, 0.2);
            text-decoration: none;
            transform: translateY(-2px);
        }

        nav a.active {
            background-color: var(--secondary);
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        nav a.active::before {
            transform: translateX(0);
            background-color: var(--primary); /* Different color for active underline */
        }


        /* Hero Section */
        .hero {
            background: linear-gradient(rgba(0, 0, 0, 0.7), rgba(0, 0, 0, 0.7)), url('https://images.unsplash.com/photo-1579684385127-1ef15d508118?ixlib=rb-4.0.3&auto=format&fit=crop&w=2070&q=80') no-repeat center center/cover;
            height: 450px; /* Slightly taller */
            display: flex;
            align-items: center;
            justify-content: center; /* Center content horizontally */
            position: relative;
            color: var(--text-light);
            text-align: center;
            overflow: hidden; /* Ensure content doesn't spill */
        }

        .hero-content {
            position: relative;
            z-index: 1;
            width: 100%;
            padding: 2rem;
            animation: fadeInScale 1s ease-out forwards;
        }

        @keyframes fadeInScale {
            from { opacity: 0; transform: scale(0.9); }
            to { opacity: 1; transform: scale(1); }
        }

        .hero h2 {
            font-family: 'Poppins', sans-serif;
            font-size: 3.2rem; /* Larger font */
            margin-bottom: 1.2rem;
            text-shadow: 2px 2px 8px rgba(0, 0, 0, 0.8);
            font-weight: 700;
            letter-spacing: -1px;
        }

        .hero p {
            font-size: 1.4rem; /* Larger font */
            max-width: 800px;
            margin: 0 auto 2.5rem;
            text-shadow: 1px 1px 4px rgba(0, 0, 0, 0.7);
            font-weight: 400;
        }

        /* Emergency Quick Links */
        .emergency-quick-links {
            background: linear-gradient(90deg, var(--secondary), var(--secondary-dark));
            color: var(--text-light);
            padding: 1.8rem 0;
            margin-bottom: 2.5rem; /* Increased margin */
            box-shadow: inset 0 3px 6px rgba(0, 0, 0, 0.1);
        }

        .quick-links-container {
            display: flex;
            justify-content: center;
            flex-wrap: wrap;
            gap: 1.8rem; /* Increased gap */
        }

        .emergency-link {
            display: flex;
            align-items: center;
            gap: 10px;
            background-color: rgba(255, 255, 255, 0.25);
            padding: 1.1rem 1.8rem; /* Larger padding */
            border-radius: 50px;
            color: var(--text-light);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.3s ease;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.15);
            backdrop-filter: blur(5px); /* Glassmorphism effect */
            border: 1px solid rgba(255, 255, 255, 0.3);
        }

        .emergency-link:hover {
            background-color: rgba(255, 255, 255, 0.4);
            transform: translateY(-5px) scale(1.02); /* More pronounced hover */
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.25);
        }

        .emergency-link .country-flag {
            height: 1.4em; /* Slightly larger flag */
            width: auto;
            border-radius: 3px;
            box-shadow: 0 0 3px rgba(0,0,0,0.3);
        }

        /* Search Section */
        #search-section {
            padding: 3.5rem 0; /* More padding */
            background-color: var(--text-light);
            border-radius: 12px; /* More rounded */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.15); /* Stronger shadow */
            margin: -120px auto 4rem; /* Lifted higher */
            position: relative;
            z-index: 2;
            max-width: 1000px;
            border: 1px solid rgba(0,0,0,0.08);
            animation: slideInUp 0.8s ease-out forwards;
        }

        @keyframes slideInUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }


        #search-section h2 {
            text-align: center;
            margin-bottom: 2.5rem;
            font-family: 'Poppins', sans-serif;
            color: var(--primary-dark);
            font-size: 2.5rem;
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.05);
        }

        .search-container {
            display: flex;
            flex-direction: column;
            gap: 2.5rem; /* Increased gap */
            padding: 0 40px; /* More padding */
        }

        .search-bar {
            display: flex;
            gap: 1.2rem; /* Increased gap */
            flex-wrap: wrap;
            align-items: stretch;
            justify-content: center; /* Center search elements */
        }

        #search-input, #category-filter {
            flex: 1;
            min-width: 280px;
            padding: 1.1rem 1.4rem; /* Larger padding */
            font-size: 1.15rem; /* Slightly larger font */
            border: 2px solid var(--gray);
            border-radius: 10px; /* More rounded */
            transition: all 0.3s ease;
            background-color: var(--light);
        }

        #search-input:focus, #category-filter:focus {
            border-color: var(--primary);
            outline: none;
            box-shadow: 0 0 0 5px rgba(37, 99, 235, 0.25); /* Stronger focus shadow */
            background-color: white;
        }

        #category-filter {
            background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='%232563eb'%3E%3Cpath fill-rule='evenodd' d='M5.293 7.293a1 1 0 011.414 0L10 10.586l3.293-3.293a1 1 0 111.414 1.414l-4 4a1 1 0 01-1.414 0l-4-4a1 1 0 010-1.414z' clip-rule='evenodd'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 1.2rem center;
            background-size: 1.4em; /* Larger arrow */
        }

        .search-button, .location-button {
            padding: 1.1rem 2.8rem; /* Larger padding */
            font-size: 1.15rem; /* Slightly larger font */
            border: none;
            border-radius: 10px; /* More rounded */
            font-weight: 700;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px; /* Increased gap */
            flex-shrink: 0;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.1);
        }

        .search-button {
            background: linear-gradient(45deg, var(--primary), var(--primary-dark));
            color: var(--text-light);
        }

        .search-button:hover:not(:disabled) {
            background: linear-gradient(45deg, var(--primary-dark), var(--primary));
            transform: translateY(-4px); /* More pronounced hover */
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        .location-button {
            background: linear-gradient(45deg, var(--success), #0ea271);
            color: var(--text-light);
        }

        .location-button:hover:not(:disabled) {
            background: linear-gradient(45deg, #0ea271, var(--success));
            transform: translateY(-4px); /* More pronounced hover */
            box-shadow: 0 8px 16px rgba(0, 0, 0, 0.2);
        }

        .search-button:disabled, .location-button:disabled {
            opacity: 0.6;
            cursor: not-allowed;
            box-shadow: none;
            transform: none;
        }

        .button-group {
            display: flex;
            gap: 1.2rem; /* Increased gap */
            flex-wrap: wrap;
            justify-content: center;
        }

        /* Search Results */
        #search-results {
            margin-top: 3rem; /* More margin */
            padding-top: 1.5rem; /* More padding */
            border-top: 2px solid var(--background-light); /* More prominent border */
        }

        .results-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 2rem; /* More margin */
            padding-bottom: 0.8rem;
            border-bottom: 3px solid var(--primary); /* Thicker border */
        }

        .results-header h3 {
            font-family: 'Poppins', sans-serif;
            color: var(--dark);
            font-size: 1.8rem; /* Larger font */
            font-weight: 700;
        }

        .results-count {
            color: var(--gray);
            font-size: 1.1rem; /* Slightly larger font */
            font-weight: 600;
        }

        .data-accuracy-note {
            font-size: 0.95rem;
            color: var(--gray);
            text-align: center;
            margin: 1.5rem 0 2rem; /* More margin */
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
            padding: 12px; /* More padding */
            background-color: #fffbe6; /* Light yellow background */
            border-left: 6px solid var(--warning); /* Thicker border */
            border-radius: 6px;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        .data-accuracy-note i {
            color: var(--warning);
            font-size: 1.2rem;
        }


        .result-item {
            background-color: var(--text-light);
            padding: 2.2rem; /* More padding */
            margin-bottom: 1.8rem; /* More margin */
            border-radius: 10px; /* More rounded */
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1); /* Stronger shadow */
            border-left: 6px solid var(--primary); /* Thicker border */
            transition: all 0.3s ease;
            cursor: pointer;
        }

        .result-item:hover {
            transform: translateY(-8px); /* More pronounced hover */
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.2);
        }

        .result-item h3 {
            color: var(--primary-dark);
            margin-bottom: 1rem; /* More margin */
            font-family: 'Poppins', sans-serif;
            font-size: 2rem; /* Larger font */
            display: flex;
            align-items: center;
            gap: 12px; /* Increased gap */
        }

        .result-item .service-icon {
            font-size: 1.8rem; /* Larger icon */
            color: var(--primary);
        }


        .result-meta {
            display: flex;
            gap: 2.5rem; /* Increased gap */
            margin-bottom: 1.5rem; /* More margin */
            flex-wrap: wrap;
            color: var(--dark);
            font-size: 1rem; /* Slightly larger font */
        }

        .result-meta span {
            display: flex;
            align-items: center;
            gap: 10px; /* Increased gap */
        }
        .result-meta i {
            color: var(--gray);
            font-size: 1.1rem;
        }

        .result-category {
            padding: 0.5rem 1.2rem; /* Larger padding */
            border-radius: 50px;
            font-size: 0.9rem; /* Slightly larger font */
            font-weight: 700;
            color: var(--text-light);
            box-shadow: 0 2px 5px rgba(0,0,0,0.15);
        }
        /* New category colors */
        .pharmacy { background-color: var(--info); }
        .veterinary_clinic { background-color: #9333ea; } /* Purple */
        .community_center { background-color: #d97706; } /* Orange */
        .fire_station { background-color: var(--danger); } /* Fire Station */
        .crisis_hotline { background-color: var(--success); } /* Hotline */


        /* Existing category colors */
        .hospital { background-color: var(--primary); }
        .police { background-color: #6b7280; }
        .shelter { background-color: var(--warning); }


        .result-actions {
            display: flex;
            gap: 1.5rem; /* Increased gap */
            margin-top: 1.8rem; /* More margin */
            flex-wrap: wrap;
        }

        .action-button {
            padding: 0.8rem 1.6rem; /* Larger padding */
            border-radius: 8px; /* More rounded */
            font-weight: 600;
            text-decoration: none;
            font-size: 1rem; /* Slightly larger font */
            display: flex;
            align-items: center;
            gap: 10px;
            transition: all 0.2s ease;
            box-shadow: 0 3px 6px rgba(0,0,0,0.1);
        }

        .call-button {
            background-color: var(--success);
            color: var(--text-light);
        }

        .call-button:hover {
            background-color: #0ea271;
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .directions-button {
            background-color: var(--primary);
            color: var(--text-light);
        }

        .directions-button:hover {
            background-color: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        .details-button {
            background-color: var(--text-light);
            color: var(--primary);
            border: 2px solid var(--primary);
        }

        .details-button:hover {
            background-color: var(--background-light);
            color: var(--primary-dark);
            transform: translateY(-3px);
            box-shadow: 0 6px 12px rgba(0,0,0,0.15);
        }

        /* New Sections Styling */
        .how-it-works, .why-choose-us {
            padding: 5rem 0;
            background-color: var(--background-light);
            border-radius: 12px;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
            margin-top: 4rem;
            text-align: center;
            animation: fadeIn 1s ease-out forwards;
        }

        @keyframes fadeIn {
            from { opacity: 0; }
            to { opacity: 1; }
        }

        .section-title {
            font-family: 'Poppins', sans-serif;
            color: var(--primary-dark);
            font-size: 2.8rem;
            font-weight: 700;
            margin-bottom: 3.5rem;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.05);
        }

        .steps-grid, .features-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2.5rem;
            margin-top: 3rem;
        }

        .step-card, .feature-card {
            background-color: var(--text-light);
            padding: 2.5rem;
            border-radius: 10px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.1);
            transition: all 0.3s ease;
            border: 1px solid rgba(0,0,0,0.08);
        }

        .step-card:hover, .feature-card:hover {
            transform: translateY(-10px) scale(1.02);
            box-shadow: 0 15px 30px rgba(0, 0, 0, 0.2);
        }

        .step-card i, .feature-card i {
            font-size: 3.5rem; /* Larger icons */
            color: var(--primary);
            margin-bottom: 1.5rem;
            transition: color 0.3s ease;
        }

        .step-card:hover i, .feature-card:hover i {
            color: var(--secondary);
        }

        .step-card h3, .feature-card h3 {
            font-family: 'Poppins', sans-serif;
            font-size: 1.8rem;
            color: var(--dark);
            margin-bottom: 1rem;
        }

        .step-card p, .feature-card p {
            color: var(--gray);
            font-size: 1.05rem;
        }


        /* Service Categories */
        .service-categories {
            padding: 5rem 0;
            background-color: var(--background-light); /* Consistent background */
            border-radius: 12px;
            box-shadow: inset 0 2px 5px rgba(0,0,0,0.05);
            margin-top: 4rem;
        }

        .categories-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2.5rem; /* Increased gap */
        }

        .category-card {
            background-color: var(--text-light);
            border-radius: 12px; /* More rounded */
            overflow: hidden;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.12); /* Stronger shadow */
            transition: all 0.4s ease;
            border: 1px solid rgba(0,0,0,0.08);
            cursor: pointer;
        }

        .category-card:hover {
            transform: translateY(-10px); /* More pronounced hover */
            box-shadow: 0 18px 35px rgba(0, 0, 0, 0.25);
        }

        .category-image {
            height: 200px; /* Taller images */
            background-size: cover;
            background-position: center;
            filter: brightness(0.9);
            transition: filter 0.3s ease, transform 0.4s ease;
        }

        .category-card:hover .category-image {
            filter: brightness(1.05);
            transform: scale(1.05); /* Zoom effect on hover */
        }

        /* Category specific images */
        .hospital-image { background-image: url('https://images.unsplash.com/photo-1586769852836-bc0237748459?auto=format&fit=crop&w=800&q=80'); }
        .fire-image { background-image: url('https://images.unsplash.com/photo-1558507663-efb5f13426e2?auto=format&fit=crop&w=800&q=80'); }
        .police-image { background-image: url('https://images.unsplash.com/photo-1621379124237-7f9a1f3c3a4d?auto=format&fit=crop&w=800&q=80'); }
        .shelter-image { background-image: url('https://images.unsplash.com/photo-1520695029094-1a3597d3e6e8?auto=format&fit=crop&w=800&q=80'); }
        .hotline-image { background-image: url('https://images.unsplash.com/photo-1557053539-7bfb3dfd96d2?auto=format&fit=crop&w=800&q=80'); }
        /* New category images */
        .pharmacy-image { background-image: url('https://images.unsplash.com/photo-1594954471089-9a0d89e7f80f?auto=format&fit=crop&w=800&q=80'); }
        .veterinary-image { background-image: url('https://images.unsplash.com/photo-1543466835-09943482596b?auto=format&fit=crop&w=800&q=80'); }
        .community-support-image { background-image: url('https://images.unsplash.com/photo-1532629399-cf5273516d61?auto=format&fit=crop&w=800&q=80'); }


        .category-content {
            padding: 2rem; /* More padding */
        }

        .category-content h3 {
            margin-bottom: 1rem;
            color: var(--dark);
            font-size: 1.6rem; /* Slightly larger font */
            font-family: 'Poppins', sans-serif;
        }

        .category-content p {
            color: var(--gray);
            margin-bottom: 1.8rem; /* More margin */
            font-size: 1.05rem;
            min-height: 60px; /* Ensure consistent height */
        }

        .category-link {
            display: inline-flex;
            align-items: center;
            gap: 10px;
            color: var(--primary);
            font-weight: 600;
            text-decoration: none;
            font-size: 1.05rem;
            transition: all 0.2s ease;
        }

        .category-link:hover {
            text-decoration: underline;
            color: var(--primary-dark);
            transform: translateX(5px); /* Slight slide effect */
        }

        /* Global Emergency Numbers */
        .global-emergency-numbers {
            padding: 5rem 0;
            background-color: var(--text-light); /* Consistent background */
            margin-top: 4rem;
        }

        .emergency-numbers-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(280px, 1fr));
            gap: 2.5rem; /* Increased gap */
            margin-top: 3.5rem;
        }

        .emergency-number-card {
            background-color: var(--background-light); /* Lighter background */
            padding: 2rem; /* More padding */
            border-radius: 12px; /* More rounded */
            box-shadow: 0 6px 15px rgba(0, 0, 0, 0.1);
            text-align: center;
            transition: all 0.3s ease;
            border: 1px solid rgba(0,0,0,0.08);
        }

        .emergency-number-card:hover {
            transform: translateY(-8px);
            box-shadow: 0 12px 25px rgba(0, 0, 0, 0.2);
        }

        .emergency-number-card h4 {
            font-family: 'Poppins', sans-serif;
            color: var(--primary-dark);
            margin-bottom: 1rem;
            font-size: 1.6rem; /* Larger font */
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 10px;
        }

        .emergency-number-card p {
            color: var(--dark);
            font-size: 1.05rem;
            margin-bottom: 1.2rem;
        }

        /* Flag specific styling for emergency number cards */
        .emergency-number-card .country-flag {
            height: 1.5em; /* Larger flags */
            width: auto;
            border-radius: 4px;
            box-shadow: 0 0 4px rgba(0,0,0,0.4);
            vertical-align: middle;
        }
        .emergency-number-card .country-flag.globe-icon {
            height: 1.5em;
            width: 1.5em;
            font-size: 1.5em;
            color: var(--primary);
            box-shadow: none;
        }

        /* Ad Container */
        .ad-container {
            margin: 3rem auto; /* More margin */
            text-align: center;
            background-color: var(--light);
            padding: 2rem; /* More padding */
            border-radius: 10px;
            box-shadow: 0 3px 8px rgba(0, 0, 0, 0.08);
            border: 2px dashed var(--gray); /* Thicker dashed border */
            color: var(--dark);
            font-style: italic;
            max-width: 728px; /* Standard ad size */
        }

        .ad-container p {
            margin-top: 15px;
            font-size: 1rem;
            color: var(--gray);
        }
        /* Crucial for AdSense: ensure the ins tag has a dimension */
        .ad-container ins {
            display: block;
            width: 100%;
            min-height: 90px; /* Example minimum height for ad slot */
        }


        /* Footer */
        footer {
            background-color: var(--dark);
            color: var(--text-light);
            padding: 5rem 0 2.5rem; /* More padding */
            border-top-left-radius: 8px;
            border-top-right-radius: 8px;
        }

        .footer-content {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(240px, 1fr)); /* Adjusted min-width */
            gap: 3rem; /* Increased gap */
            margin-bottom: 3.5rem;
        }

        .footer-column h3 {
            font-family: 'Poppins', sans-serif;
            margin-bottom: 2rem; /* More margin */
            color: var(--text-light);
            font-size: 1.6rem; /* Larger font */
            border-bottom: 3px solid var(--primary); /* Thicker border */
            padding-bottom: 0.6rem;
            display: inline-block;
        }

        .footer-column ul {
            list-style: none;
        }

        .footer-column li {
            margin-bottom: 1.2rem; /* More space between items */
        }

        .footer-column a {
            color: var(--gray);
            text-decoration: none;
            transition: all 0.3s ease;
            font-size: 1.05rem;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .footer-column a:hover {
            color: var(--text-light);
            text-decoration: underline;
            transform: translateX(5px); /* Slight slide effect */
        }

        .social-links {
            display: flex;
            gap: 1.5rem; /* Increased gap */
            margin-top: 2rem;
        }

        .social-links a {
            display: flex;
            align-items: center;
            justify-content: center;
            width: 45px; /* Larger icons */
            height: 45px;
            background-color: rgba(255, 255, 255, 0.18); /* Slightly more opaque */
            border-radius: 50%;
            color: var(--text-light);
            transition: all 0.3s ease;
            font-size: 1.4rem; /* Larger icons */
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }

        .social-links a:hover {
            background-color: var(--primary);
            transform: translateY(-6px) rotate(5deg); /* More dynamic hover */
            box-shadow: 0 8px 15px rgba(0, 0, 0, 0.3);
        }

        .footer-bottom {
            text-align: center;
            padding-top: 2.5rem;
            border-top: 1px solid rgba(255, 255, 255, 0.15);
            color: var(--gray);
            font-size: 0.95rem;
        }

        .footer-bottom a {
            color: var(--gray);
            text-decoration: none;
            transition: color 0.3s ease;
        }

        .footer-bottom a:hover {
            color: var(--text-light);
            text-decoration: underline;
        }

        /* --- Loading States & Empty Results UI --- */
        .loading-spinner {
            border: 5px solid #f3f3f3; /* Thicker border */
            border-top: 5px solid var(--primary); /* Thicker border */
            border-radius: 50%;
            width: 40px; /* Larger spinner */
            height: 40px;
            animation: spin 1s linear infinite;
            margin: 30px auto; /* More margin */
            display: block;
        }

        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }

        .no-results-message {
            text-align: center;
            padding: 40px; /* More padding */
            background-color: var(--text-light);
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.08);
            color: var(--dark);
            margin-top: 2rem;
            border: 1px solid var(--background-light);
        }

        .no-results-message p {
            margin-bottom: 1.2rem;
            font-size: 1.2rem; /* Larger font */
        }

        /* --- Emergency SOS Button --- */
        #sos-button {
            position: fixed;
            bottom: 35px; /* Slightly higher */
            right: 35px; /* Slightly further right */
            width: 90px; /* Larger button */
            height: 90px;
            border-radius: 50%;
            background: linear-gradient(45deg, var(--danger), var(--secondary)); /* Gradient background */
            color: var(--text-light);
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-family: 'Poppins', sans-serif;
            font-weight: 700;
            font-size: 1.2rem; /* Larger font */
            box-shadow: 0 10px 20px rgba(239, 68, 68, 0.5); /* Stronger shadow */
            border: none;
            cursor: pointer;
            transition: all 0.3s ease;
            z-index: 999;
            text-decoration: none;
            text-transform: uppercase;
            letter-spacing: 1px;
        }

        #sos-button:hover {
            background: linear-gradient(45deg, var(--secondary), var(--danger)); /* Reverse gradient on hover */
            transform: translateY(-8px) scale(1.08); /* More pronounced hover */
            box-shadow: 0 16px 30px rgba(239, 68, 68, 0.7);
        }

        #sos-button i {
            font-size: 2.5rem; /* Larger icon */
            margin-bottom: 8px;
            animation: pulse 1.5s infinite cubic-bezier(0.4, 0, 0.6, 1); /* Smoother pulse */
        }

        @keyframes pulse {
            0% { transform: scale(1); }
            50% { transform: scale(1.15); } /* More pronounced pulse */
            100% { transform: scale(1); }
        }

        /* --- Modal Styles --- */
        .modal {
            display: none;
            position: fixed;
            z-index: 1000;
            left: 0;
            top: 0;
            width: 100%;
            height: 100%;
            overflow: auto;
            background-color: rgba(0,0,0,0.8); /* Darker overlay */
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease-out;
        }

        .modal.active {
            display: flex;
            opacity: 1;
        }

        .modal-content {
            background-color: var(--text-light);
            margin: auto;
            padding: 40px; /* More padding */
            border-radius: 15px; /* More rounded */
            box-shadow: 0 15px 40px rgba(0,0,0,0.3); /* Stronger shadow */
            width: 90%;
            max-width: 700px; /* Wider modal */
            position: relative;
            animation: fadeInSlideUp 0.4s ease-out forwards;
            border: 1px solid rgba(0,0,0,0.1);
        }

        @keyframes fadeInSlideUp {
            from { opacity: 0; transform: translateY(50px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .close-button {
            color: var(--gray);
            font-size: 32px; /* Larger close button */
            font-weight: bold;
            position: absolute;
            top: 15px;
            right: 20px;
            cursor: pointer;
            transition: color 0.3s ease, transform 0.2s ease;
        }

        .close-button:hover,
        .close-button:focus {
            color: var(--dark);
            transform: rotate(90deg); /* Rotate on hover */
            text-decoration: none;
        }

        .modal-content h3 {
            color: var(--primary-dark);
            font-family: 'Poppins', sans-serif;
            font-size: 2.2rem; /* Larger font */
            margin-bottom: 1.2rem;
            border-bottom: 3px solid var(--primary); /* Thicker border */
            padding-bottom: 0.8rem;
            display: flex;
            align-items: center;
            gap: 15px; /* Increased gap */
        }
        .modal-content .service-icon {
            font-size: 2rem; /* Larger icon */
            color: var(--primary);
        }


        .modal-meta {
            display: flex;
            flex-direction: column;
            gap: 1rem; /* Increased gap */
            margin-bottom: 2rem; /* More margin */
            color: var(--dark);
            font-size: 1.05rem; /* Slightly larger font */
        }
        .modal-meta span i {
            color: var(--gray);
            font-size: 1.1rem;
        }

        .modal-meta a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.2s ease;
        }

        .modal-meta a:hover {
            text-decoration: underline;
            color: var(--primary-dark);
        }

        .modal-meta .result-category {
            align-self: flex-start;
            margin-bottom: 0.8rem;
            padding: 0.6rem 1.4rem; /* Larger padding */
            font-size: 0.95rem;
        }

        .modal-photo {
            max-width: 100%;
            height: auto;
            border-radius: 10px;
            margin-top: 1.5rem;
            box-shadow: 0 6px 15px rgba(0,0,0,0.15);
            display: block; /* Ensure it takes full width if present */
        }

        .modal-content p {
            font-size: 1.15rem; /* Slightly larger font */
            line-height: 1.8;
            color: var(--dark);
            margin-bottom: 2.5rem; /* More margin */
        }

        .modal-actions {
            display: flex;
            flex-wrap: wrap;
            gap: 1.5rem; /* Increased gap */
            justify-content: center; /* Center buttons */
        }
        .modal-actions .action-button {
            flex-grow: 1;
            justify-content: center;
            padding: 1rem 1.8rem; /* Larger padding */
            font-size: 1.05rem;
        }

        /* General Page Styling for About, Contact, Privacy, Terms */
        .content-page {
            padding: 6rem 0 4rem;
            min-height: 60vh;
            background-color: var(--text-light); /* Ensure consistent background */
            border-radius: 12px;
            box-shadow: 0 8px 20px rgba(0, 0, 0, 0.08);
            margin-top: 4rem;
            border: 1px solid rgba(0,0,0,0.05);
        }

        .content-page h2 {
            text-align: center;
            margin-bottom: 3rem; /* More margin */
            font-family: 'Poppins', sans-serif;
            color: var(--primary-dark);
            font-size: 2.8rem; /* Larger font */
            font-weight: 700;
            text-shadow: 1px 1px 2px rgba(0, 0, 0, 0.05);
        }

        .content-page h3 {
            color: var(--dark);
            font-family: 'Poppins', sans-serif;
            font-size: 2rem; /* Larger font */
            margin-top: 2.5rem; /* More margin */
            margin-bottom: 1.2rem;
            border-bottom: 2px solid var(--background-light); /* Thicker border */
            padding-bottom: 0.6rem;
        }

        .content-page p, .content-page ul, .content-page ol {
            margin-bottom: 1.8rem; /* More margin */
            line-height: 1.8;
            font-size: 1.1rem; /* Slightly larger font */
            color: var(--dark);
        }

        .content-page ul, .content-page ol {
            margin-left: 30px; /* More indentation */
        }

        .content-page ul li, .content-page ol li {
            margin-bottom: 0.8rem;
        }

        .contact-info {
            max-width: 700px; /* Wider contact info */
            margin: 0 auto;
            text-align: center;
            padding: 2rem;
            background-color: var(--background-light);
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0,0,0,0.05);
            border: 1px solid rgba(0,0,0,0.05);
        }

        .contact-info p {
            font-size: 1.2rem; /* Larger font */
            margin-bottom: 1.2rem;
        }

        .contact-info a {
            color: var(--primary);
            text-decoration: none;
            font-weight: 600;
            transition: all 0.2s ease;
        }
        .contact-info a:hover {
            color: var(--primary-dark);
            text-decoration: underline;
        }
        .contact-info i {
            margin-right: 8px;
            color: var(--primary);
        }


        /* Responsive Adjustments */
        @media (max-width: 992px) {
            header h1 { font-size: 1.7rem; }
            nav ul { gap: 1.2rem; }
            nav a { padding: 0.5rem 0.9rem; font-size: 0.95rem; }

            .hero { height: 400px; }
            .hero h2 { font-size: 2.8rem; }
            .hero p { font-size: 1.2rem; }

            .emergency-quick-links { padding: 1.5rem 0; margin-bottom: 2rem; }
            .quick-links-container { gap: 1.2rem; }
            .emergency-link { padding: 0.9rem 1.4rem; font-size: 0.95rem; }

            #search-section { padding: 3rem 0; margin: -100px auto 3rem; }
            #search-section h2 { font-size: 2.2rem; }
            .search-container { padding: 0 30px; gap: 1.5rem; }
            #search-input, #category-filter { padding: 1rem 1.2rem; font-size: 1.05rem; }
            .search-button, .location-button { padding: 1rem 2.2rem; font-size: 1.05rem; }

            .results-header h3 { font-size: 1.6rem; }
            .results-count { font-size: 1rem; }
            .data-accuracy-note { font-size: 0.95rem; margin: 1.2rem 0 1.5rem; padding: 10px; }

            .result-item { padding: 1.8rem; margin-bottom: 1.2rem; }
            .result-item h3 { font-size: 1.7rem; gap: 10px; }
            .result-item .service-icon { font-size: 1.5rem; }
            .result-meta { gap: 1.5rem; font-size: 0.95rem; }
            .result-actions { gap: 1rem; margin-top: 1.2rem; }
            .action-button { padding: 0.7rem 1.4rem; font-size: 0.95rem; }

            .how-it-works, .why-choose-us, .service-categories, .global-emergency-numbers, .content-page { padding: 4rem 0; margin-top: 3rem; }
            .section-title { font-size: 2.5rem; margin-bottom: 3rem; }
            .steps-grid, .features-grid, .categories-grid, .emergency-numbers-grid { gap: 2rem; }
            .step-card i, .feature-card i { font-size: 3rem; margin-bottom: 1.2rem; }
            .step-card h3, .feature-card h3 { font-size: 1.6rem; }
            .step-card p, .feature-card p { font-size: 1rem; }
            .category-image { height: 180px; }
            .category-content h3 { font-size: 1.4rem; }
            .category-content p { font-size: 0.95rem; min-height: 50px; }
            .emergency-number-card h4 { font-size: 1.4rem; }

            footer { padding: 4rem 0 2rem; }
            .footer-content { gap: 2rem; }
            .footer-column h3 { font-size: 1.4rem; }
            .footer-column ul li { margin-bottom: 0.8rem; }
            .footer-column a { font-size: 0.95rem; }
            .social-links { margin-top: 1.5rem; }

            #sos-button { width: 80px; height: 80px; font-size: 1.1rem; bottom: 30px; right: 30px; }
            #sos-button i { font-size: 2.2rem; margin-bottom: 5px; }

            .modal-content { max-width: 600px; padding: 30px; }
            .modal-content h3 { font-size: 2rem; }
            .modal-content .service-icon { font-size: 1.8rem; }
            .modal-meta { font-size: 1rem; }
            .modal-content p { font-size: 1.1rem; }
            .modal-actions { gap: 1.2rem; }
        }

        @media (max-width: 768px) {
            .header-content { flex-direction: column; gap: 1.5rem; }
            nav ul { flex-wrap: wrap; justify-content: center; gap: 1rem; }
            nav a { padding: 0.4rem 0.8rem; font-size: 0.9rem; }

            .hero { height: 350px; }
            .hero h2 { font-size: 2.4rem; margin-bottom: 1rem; }
            .hero p { font-size: 1.1rem; margin-bottom: 2rem; }

            .emergency-quick-links { padding: 1.2rem 0; margin-bottom: 1.8rem; }
            .quick-links-container { gap: 1rem; }
            .emergency-link { padding: 0.8rem 1.2rem; font-size: 0.9rem; gap: 8px; }
            .emergency-link .country-flag { height: 1.1em; }

            #search-section { padding: 2.5rem 0; margin: -80px auto 2.5rem; }
            #search-section h2 { font-size: 2rem; margin-bottom: 2rem; }
            .search-container { padding: 0 20px; gap: 1.2rem; }
            .search-bar { flex-direction: column; gap: 1rem; }
            #search-input, #category-filter { width: 100%; min-width: unset; padding: 0.9rem 1.1rem; font-size: 1rem; }
            .button-group { width: 100%; flex-direction: column; gap: 1rem; }
            .search-button, .location-button { flex: 1; width: 100%; padding: 0.9rem 1.8rem; font-size: 1rem; }

            .results-header h3 { font-size: 1.4rem; }
            .results-count { font-size: 0.9rem; }
            .data-accuracy-note { font-size: 0.9rem; margin: 1.2rem 0 1.5rem; padding: 10px; }

            .result-item { padding: 1.5rem; margin-bottom: 1rem; }
            .result-item h3 { font-size: 1.5rem; gap: 10px; }
            .result-item .service-icon { font-size: 1.3rem; }
            .result-meta { flex-direction: column; gap: 0.8rem; font-size: 0.9rem; }
            .result-actions { flex-direction: column; gap: 0.8rem; margin-top: 1rem; }
            .action-button { justify-content: center; width: 100%; padding: 0.7rem 1.2rem; font-size: 0.9rem; }

            .how-it-works, .why-choose-us, .service-categories, .global-emergency-numbers, .content-page { padding: 3rem 0; margin-top: 2.5rem; }
            .section-title { font-size: 2.2rem; margin-bottom: 2.5rem; }
            .steps-grid, .features-grid, .categories-grid, .emergency-numbers-grid { gap: 1.5rem; }
            .step-card i, .feature-card i { font-size: 2.5rem; margin-bottom: 1rem; }
            .step-card h3, .feature-card h3 { font-size: 1.4rem; }
            .step-card p, .feature-card p { font-size: 0.95rem; }
            .category-image { height: 160px; }
            .category-content { padding: 1.5rem; }
            .category-content h3 { font-size: 1.3rem; }
            .category-content p { font-size: 0.9rem; min-height: 40px; }
            .emergency-number-card h4 { font-size: 1.3rem; }

            footer { padding: 3rem 0 1.5rem; }
            .footer-content { grid-template-columns: 1fr; text-align: center; gap: 1.8rem; }
            .footer-column h3 { display: block; margin-left: auto; margin-right: auto; }
            .footer-column ul { padding: 0; }
            .social-links { justify-content: center; }

            #sos-button { width: 70px; height: 70px; font-size: 1rem; bottom: 25px; right: 25px; }
            #sos-button i { font-size: 2rem; margin-bottom: 4px; }

            .modal-content { width: 95%; padding: 25px; border-radius: 12px; }
            .modal-content h3 { font-size: 1.8rem; gap: 10px; }
            .modal-content .service-icon { font-size: 1.6rem; }
            .modal-meta { font-size: 0.95rem; gap: 0.8rem; margin-bottom: 1.5rem; }
            .modal-content p { font-size: 1.05rem; margin-bottom: 2rem; }
            .modal-actions { flex-direction: column; gap: 1rem; }
            .modal-actions .action-button { padding: 0.8rem 1.5rem; font-size: 1rem; }

            .content-page h2 { font-size: 2.2rem; margin-bottom: 2rem; }
            .content-page h3 { font-size: 1.6rem; margin-top: 2rem; margin-bottom: 1rem; }
            .content-page p, .content-page ul, .content-page ol { font-size: 1rem; margin-bottom: 1.5rem; }
            .contact-info { padding: 1.5rem; }
            .contact-info p { font-size: 1.1rem; }
        }

        @media (max-width: 480px) {
            header h1 { font-size: 1.5rem; }
            .logo i { font-size: 1.8rem; }
            nav ul { gap: 0.6rem; }
            nav a { padding: 0.3rem 0.6rem; font-size: 0.85rem; }

            .hero { height: 300px; }
            .hero h2 { font-size: 2rem; margin-bottom: 0.8rem; }
            .hero p { font-size: 1rem; margin-bottom: 1.5rem; }

            .emergency-quick-links { padding: 1rem 0; margin-bottom: 1.5rem; }
            .quick-links-container { gap: 0.8rem; }
            .emergency-link { padding: 0.7rem 1rem; font-size: 0.85rem; gap: 6px; }
            .emergency-link .country-flag { height: 1em; }

            #search-section { padding: 2rem 0; margin: -60px auto 2rem; border-radius: 8px; }
            #search-section h2 { font-size: 1.8rem; margin-bottom: 1.5rem; }
            .search-container { padding: 0 15px; gap: 1rem; }
            #search-input, #category-filter { padding: 0.8rem 1rem; font-size: 0.95rem; border-radius: 8px; }
            .search-button, .location-button { padding: 0.8rem 1.5rem; font-size: 0.95rem; border-radius: 8px; }

            .results-header h3 { font-size: 1.2rem; }
            .results-count { font-size: 0.8rem; }
            .data-accuracy-note { font-size: 0.8rem; margin: 1rem 0; padding: 8px; }

            .result-item { padding: 1.2rem; margin-bottom: 0.8rem; border-radius: 8px; border-left-width: 4px; }
            .result-item h3 { font-size: 1.3rem; gap: 8px; }
            .result-item .service-icon { font-size: 1.1rem; }
            .result-meta { flex-direction: column; gap: 0.5rem; font-size: 0.85rem; }
            .result-actions { flex-direction: column; gap: 0.6rem; margin-top: 0.8rem; }
            .action-button { padding: 0.6rem 1rem; font-size: 0.85rem; border-radius: 6px; }

            .how-it-works, .why-choose-us, .service-categories, .global-emergency-numbers, .content-page { padding: 2.5rem 0; margin-top: 2rem; border-radius: 8px; }
            .section-title { font-size: 1.8rem; margin-bottom: 2rem; }
            .steps-grid, .features-grid, .categories-grid, .emergency-numbers-grid { gap: 1.2rem; }
            .step-card, .feature-card { padding: 2rem; border-radius: 8px; }
            .step-card i, .feature-card i { font-size: 2rem; margin-bottom: 0.8rem; }
            .step-card h3, .feature-card h3 { font-size: 1.2rem; }
            .step-card p, .feature-card p { font-size: 0.85rem; }
            .category-image { height: 140px; }
            .category-content { padding: 1.2rem; }
            .category-content h3 { font-size: 1.1rem; }
            .category-content p { font-size: 0.85rem; min-height: 30px; }
            .category-link { font-size: 0.85rem; }
            .emergency-number-card h4 { font-size: 1.1rem; }
            .emergency-number-card p { font-size: 0.9rem; }

            footer { padding: 3rem 0 1.5rem; border-radius: 8px; }
            .footer-content { gap: 1.5rem; }
            .footer-column h3 { font-size: 1.2rem; margin-bottom: 1.5rem; }
            .footer-column ul li { margin-bottom: 0.6rem; }
            .footer-column a { font-size: 0.85rem; }
            .social-links { margin-top: 1rem; gap: 1rem; }
            .social-links a { width: 35px; height: 35px; font-size: 1.1rem; }
            .footer-bottom { padding-top: 1.5rem; font-size: 0.8rem; }

            #sos-button { width: 60px; height: 60px; font-size: 0.9rem; bottom: 15px; right: 15px; }
            #sos-button i { font-size: 1.8rem; margin-bottom: 2px; }

            .modal-content { padding: 20px; border-radius: 10px; }
            .modal-content h3 { font-size: 1.5rem; gap: 8px; }
            .modal-content .service-icon { font-size: 1.4rem; }
            .modal-meta { font-size: 0.9rem; gap: 0.6rem; margin-bottom: 1.2rem; }
            .modal-content p { font-size: 0.95rem; margin-bottom: 1.5rem; }
            .modal-actions { flex-direction: column; gap: 0.8rem; }
            .modal-actions .action-button { padding: 0.7rem 1.2rem; font-size: 0.9rem; }

            .content-page h2 { font-size: 1.8rem; margin-bottom: 1.5rem; }
            .content-page h3 { font-size: 1.4rem; margin-top: 1.8rem; margin-bottom: 0.8rem; }
            .content-page p, .content-page ul, .content-page ol { font-size: 0.95rem; margin-bottom: 1.2rem; }
            .contact-info { padding: 1rem; }
            .contact-info p { font-size: 1rem; }
        }
    </style>
</head>
<body>
    <header>
        <div class="container">
            <div class="header-content">
                <a href="#home" class="logo" aria-label="Global EmergencyFinder Home">
                    <i class="fas fa-ambulance"></i>
                    <h1>Global Emergency<span style="font-weight: 300;">Finder</span></h1>
                </a>
                <nav aria-label="Main navigation">
                    <ul>
                        <li><a href="#home" class="active" aria-current="page">Home</a></li>
                        <li><a href="#categories-section">Services</a></li>
                        <li><a href="#emergency-numbers-section">Emergency Numbers</a></li>
                        <li><a href="#about-us-section">About Us</a></li>
                        <li><a href="#contact-us-section">Contact</a></li>
                        <li><a href="#privacy-policy-section">Privacy Policy</a></li>
                        <li><a href="#terms-of-service-section">Terms of Service</a></li>
                    </ul>
                </nav>
            </div>
        </div>
    </header>

    <section class="hero" id="home">
        <div class="hero-content container">
            <h2>Find Emergency Help Anywhere</h2>
            <p>Locate hospitals, fire stations, shelters, and crisis support services near you, anywhere in the world.</p>
        </div>
    </section>

    <section class="emergency-quick-links" id="quick-links">
        <div class="container quick-links-container" id="dynamic-emergency-links">
            <!-- Dynamic emergency numbers for current location will be loaded here by script.js -->
        </div>
    </section>

    <main class="container">
        <section id="search-section">
            <h2>Find Emergency Services Near You</h2>
            <div class="search-container">
                <div class="search-bar">
                    <input type="text" id="search-input" placeholder="Enter city, country, or service (e.g., 'hospital in Tokyo')" aria-label="Search emergency services">
                    <select id="category-filter" aria-label="Filter by service category">
                        <option value="all">All Services</option>
                        <option value="hospital">Hospitals</option>
                        <option value="fire_station">Fire Departments</option>
                        <option value="police">Police Stations</option>
                        <option value="pharmacy">Pharmacies</option>
                        <option value="veterinary_care">Veterinary Clinics</option>
                        <option value="shelter">Shelters</option>
                        <option value="crisis_hotline">Crisis Hotlines</option>
                        <option value="community_center">Community Support</option>
                    </select>
                    <div class="button-group">
                        <button class="search-button" onclick="searchServices()">
                            <i class="fas fa-search"></i> Search
                        </button>
                        <button class="location-button" onclick="getLocation()">
                            <i class="fas fa-location-arrow"></i> Near Me
                        </button>
                    </div>
                </div>

                <div class="ad-container in-content-ad">
                    <p>Advertisement</p>
                    <ins class="adsbygoogle"
                        style="display:block; width:100%;"
                        data-ad-client="ca-pub-6066867577696178"
                        data-ad-slot="1980363673"
                        data-ad-format="auto"
                        data-full-width-responsive="true"></ins>
                    <script>
                        (adsbygoogle = window.adsbygoogle || []).push({});
                    </script>
                </div>

                <div id="search-results" aria-live="polite">
                    <div class="results-header">
                        <h3>Emergency Services</h3>
                        <span class="results-count" id="results-count">Enter a location or use 'Near Me' to find services...</span>
                    </div>
                    <p class="data-accuracy-note">
                        <i class="fas fa-info-circle"></i> Information is sourced from Google Places API and may not be real-time. Please verify details directly with the service provider.
                    </p>
                    <div id="results-list">
                        <!-- Search results will be dynamically loaded here by script.js -->
                    </div>
                </div>
            </div>
        </section>

        <section class="how-it-works">
            <div class="container">
                <h2 class="section-title">How It Works</h2>
                <div class="steps-grid">
                    <div class="step-card">
                        <i class="fas fa-map-marker-alt"></i>
                        <h3>1. Find Your Location</h3>
                        <p>Automatically detect your current location or manually enter a city and country.</p>
                    </div>
                    <div class="step-card">
                        <i class="fas fa-search"></i>
                        <h3>2. Search for Services</h3>
                        <p>Enter a service type (e.g., "hospital") or browse by categories like Police, Fire, or Shelter.</p>
                    </div>
                    <div class="step-card">
                        <i class="fas fa-info-circle"></i>
                        <h3>3. View Details</h3>
                        <p>Get essential information like addresses, phone numbers, and operating hours for nearby services.</p>
                    </div>
                    <div class="step-card">
                        <i class="fas fa-phone-alt"></i>
                        <h3>4. Get Help Fast</h3>
                        <p>Instantly call emergency numbers or get directions through integrated mapping tools.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="why-choose-us">
            <div class="container">
                <h2 class="section-title">Why Choose Global EmergencyFinder?</h2>
                <div class="features-grid">
                    <div class="feature-card">
                        <i class="fas fa-globe"></i>
                        <h3>Global Coverage</h3>
                        <p>Access critical emergency services and numbers in countries worldwide.</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-shield-alt"></i>
                        <h3>Reliable Data</h3>
                        <p>Powered by Google Places API for up-to-date and comprehensive service listings.</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-mobile-alt"></i>
                        <h3>Mobile-Friendly</h3>
                        <p>Designed for quick and easy use on any smartphone or tablet in an emergency.</p>
                    </div>
                    <div class="feature-card">
                        <i class="fas fa-hand-holding-heart"></i>
                        <h3>Community Focused</h3>
                        <p>A non-profit initiative dedicated to public safety and well-being.</p>
                    </div>
                </div>
            </div>
        </section>

        <section class="service-categories" id="categories-section">
            <h2 class="section-title">Service Categories</h2>
            <div class="categories-grid">
                <div class="category-card">
                    <div class="category-image hospital-image" role="img" aria-label="Hospital building"></div>
                    <div class="category-content">
                        <h3>Hospitals & Clinics</h3>
                        <p>Find emergency rooms, urgent care centers, and medical facilities worldwide.</p>
                        <a href="#search-section" class="category-link" onclick="filterCategory('hospital')">
                            View Hospitals <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
                <div class="category-card">
                    <div class="category-image fire-image" role="img" aria-label="Fire truck with lights on"></div>
                    <div class="category-content">
                        <h3>Fire Departments</h3>
                        <p>Locate fire stations and emergency response teams in your region.</p>
                        <a href="#search-section" class="category-link" onclick="filterCategory('fire_station')">
                            View Fire Stations <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
                <div class="category-card">
                    <div class="category-image police-image" role="img" aria-label="Police car with siren lights"></div>
                    <div class="category-content">
                        <h3>Police Stations</h3>
                        <p>Find local law enforcement and emergency police services globally.</p>
                        <a href="#search-section" class="category-link" onclick="filterCategory('police')">
                            View Police Stations <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
                <div class="category-card">
                    <div class="category-image pharmacy-image" role="img" aria-label="Pharmacy interior with medicines"></div>
                    <div class="category-content">
                        <h3>Pharmacies</h3>
                        <p>Locate pharmacies and drug stores for medical supplies and prescriptions.</p>
                        <a href="#search-section" class="category-link" onclick="filterCategory('pharmacy')">
                            View Pharmacies <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
                <div class="category-card">
                    <div class="category-image veterinary-image" role="img" aria-label="Veterinarian examining a dog"></div>
                    <div class="category-content">
                        <h3>Veterinary Clinics</h3>
                        <p>Find animal hospitals and veterinary services for your pets' emergency needs.</p>
                        <a href="#search-section" class="category-link" onclick="filterCategory('veterinary_care')">
                            View Vets <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
                <div class="category-card">
                    <div class="category-image shelter-image" role="img" aria-label="People gathered at a shelter"></div>
                    <div class="category-content">
                        <h3>Shelters</h3>
                        <p>Emergency housing, domestic violence shelters, and homeless services worldwide.</p>
                        <a href="#search-section" class="category-link" onclick="filterCategory('shelter')">
                            View Shelters <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
                <div class="category-card">
                    <div class="category-image hotline-image" role="img" aria-label="Person talking on a phone headset"></div>
                    <div class="category-content">
                        <h3>Crisis Hotlines</h3>
                        <p>24/7 support for mental health, suicide prevention, and domestic violence globally.</p>
                        <a href="#search-section" class="category-link" onclick="filterCategory('crisis_hotline')">
                            View Hotlines <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
                <div class="category-card">
                    <div class="category-image community-support-image" role="img" aria-label="People holding hands in a circle"></div>
                    <div class="category-content">
                        <h3>Community Support</h3>
                        <p>Local centers offering aid, food, social services, and community resources.</p>
                        <a href="#search-section" class="category-link" onclick="filterCategory('community_center')">
                            View Centers <i class="fas fa-arrow-right"></i>
                        </a>
                    </div>
                </div>
            </div>
        </section>

        <section class="global-emergency-numbers" id="emergency-numbers-section">
            <h2 class="section-title">Global Emergency Numbers</h2>
            <div class="emergency-numbers-grid" id="emergency-numbers-grid">
                <!-- Global emergency numbers will be dynamically loaded here by script.js -->
            </div>
        </section>

        <section class="about-section" id="about-us-section">
            <div class="container">
                <div class="about-content">
                    <h2>About Global EmergencyFinder</h2>
                    <p>Global EmergencyFinder is a non-profit initiative dedicated to providing immediate and reliable access to critical emergency services around the globe. In moments of crisis, every second counts, and our mission is to ensure that anyone, anywhere, can quickly locate the help they need.</p>
                    <p>We leverage robust public data sources, primarily **Google Places API**, to compile our directory. This data is regularly updated by Google and its community. While we strive for accuracy, the real-time availability of specific services (e.g., specific pharmacy opening hours, shelter bed availability) can vary and should always be verified by contacting the service directly.</p>
                    <p>If you represent an emergency service and would like to be listed or update your information, please <a href="#contact-us-section" style="color: var(--primary); font-weight: 600;">contact us</a>.</p>
                </div>
            </div>
        </section>
    </main>

    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-column">
                    <h3>Global EmergencyFinder</h3>
                    <p style="color: var(--gray); margin-bottom: 1rem;">Your trusted resource for locating emergency services worldwide, quickly and reliably.</p>
                    <div class="social-links">
                        <a href="https://www.facebook.com" aria-label="Facebook" target="_blank" rel="noopener noreferrer"><i class="fab fa-facebook-f"></i></a>
                        <a href="https://www.twitter.com" aria-label="Twitter" target="_blank" rel="noopener noreferrer"><i class="fab fa-twitter"></i></a>
                        <a href="https://www.instagram.com" aria-label="Instagram" target="_blank" rel="noopener noreferrer"><i class="fab fa-instagram"></i></a>
                    </div>
                </div>
                <div class="footer-column">
                    <h3>Quick Links</h3>
                    <ul>
                        <li><a href="#home">Home</a></li>
                        <li><a href="#categories-section">Service Categories</a></li>
                        <li><a href="#emergency-numbers-section">Emergency Numbers</a></li>
                        <li><a href="#about-us-section">About Us</a></li>
                        <li><a href="#contact-us-section">Contact</a></li>
                    </ul>
                </div>
                <div class="footer-column">
                    <h3>Resources</h3>
                    <ul>
                        <li><a href="https://www.who.int/emergencies" target="_blank" rel="noopener noreferrer">World Health Organization</a></li>
                        <li><a href="https://www.ifrc.org" target="_blank" rel="noopener noreferrer">International Red Cross</a></li>
                        <li><a href="https://www.unicef.org/emergencies" target="_blank" rel="noopener noreferrer">UNICEF Emergencies</a></li>
                        <li><a href="https://www.ready.gov" target="_blank" rel="noopener noreferrer">Emergency Preparedness (USA)</a></li>
                    </ul>
                </div>
                <div class="footer-column" id="contact-footer">
                    <h3>Contact</h3>
                    <ul>
                        <li><a href="mailto:spreadinghappiness@gmail.com"><i class="fas fa-envelope"></i> spreadinghappiness@gmail.com</a></li>
                        <li><a href="tel:0000000000"><i class="fas fa-phone-alt"></i> 0000000000</a></li>
                        <li><i class="fas fa-map-marker-alt"></i> GHAZIABAD<br>UTTAR PRADESH INDIA 201206</li>
                    </ul>
                </div>
            </div>
            <div class="footer-bottom">
                <p>© 2025 Global EmergencyFinder. All rights reserved. | <a href="#privacy-policy-section" style="color: var(--gray);">Privacy Policy</a> | <a href="#terms-of-service-section" style="color: var(--gray);">Terms of Service</a></p>
            </div>
        </div>
    </footer>

    <button id="sos-button" aria-label="Emergency SOS - Call for Help" onclick="triggerEmergencySOS()">
        <i class="fas fa-triangle-exclamation"></i>
        SOS
    </button>

    <div id="service-details-modal" class="modal">
        <div class="modal-content">
            <span class="close-button" onclick="closeModal()" aria-label="Close details modal">×</span>
            <h3 id="modal-service-name"></h3>
            <div class="modal-meta">
                <span id="modal-service-category" class="result-category"></span>
                <span id="modal-service-location"><i class="fas fa-map-marker-alt"></i></span>
                <span id="modal-service-phone"><i class="fas fa-phone-alt"></i></span>
                <span id="modal-service-hours"><i class="far fa-clock"></i></span>
                <span id="modal-service-website" style="display:none;"><i class="fas fa-globe"></i> <a href="#" target="_blank" rel="noopener noreferrer">Website</a></span>
                <span id="modal-service-photo" style="display:none;"><img src="" alt="Service Photo" class="modal-photo"></span>
            </div>
            <p id="modal-service-description"></p>
            <div class="modal-actions">
                <a id="modal-call-button" href="#" class="action-button call-button"><i class="fas fa-phone-alt"></i> Call</a>
                <a id="modal-directions-button" href="#" target="_blank" rel="noopener noreferrer" class="action-button directions-button"><i class="fas fa-directions"></i> Get Directions</a>
                <a id="modal-hotline-link" href="#" target="_blank" rel="noopener noreferrer" class="action-button details-button" style="display:none;"><i class="fas fa-info-circle"></i> Learn More</a>
            </div>
        </div>
    </div>

    <!-- START: Embedded content from about.html, contact.html, privacy.html, terms.html -->

    <!-- About Us Section (from about.html) -->
    <section class="content-page" id="about-us-section">
        <h2 class="section-title">About Global EmergencyFinder</h2>
        <p>Global EmergencyFinder is a non-profit initiative dedicated to providing immediate and reliable access to critical emergency services around the globe. In moments of crisis, every second counts, and our mission is to ensure that anyone, anywhere, can quickly locate the help they need.</p>

        <h3>Our Mission</h3>
        <p>To empower individuals worldwide by offering a fast, intuitive, and comprehensive directory of emergency services, utilizing advanced technology to bridge the gap between people in need and available support.</p>

        <h3>Our Vision</h3>
        <p>A world where geographical barriers and language differences never hinder access to vital emergency assistance, ensuring safety and well-being for all.</p>

        <h3>How We Work</h3>
        <p>We leverage robust public data sources, primarily **Google Places API**, to aggregate a vast network of hospitals, fire departments, police stations, shelters, pharmacies, veterinary clinics, and community support centers. Our system is designed to use real-time location data (with your permission) and intelligent search algorithms to pinpoint the closest and most relevant services.</p>
        <p>We believe in collaboration and accuracy. Our directory is continuously updated through automated processes and community contributions. We cross-reference data with official sources like the World Health Organization (WHO) and the International Federation of Red Cross and Red Crescent Societies (IFRC) to maintain the highest level of data integrity.</p>

        <h3>Our Commitment to You</h3>
        <ul>
            <li>**Accuracy:** We strive to provide the most accurate and up-to-date information possible. However, as our data is crowd-sourced, some details (like real-time operating hours or specific service availability) may vary. Always verify critical information directly with the service provider.</li>
            <li>**Accessibility:** Our platform is designed to be easy to use on any device, ensuring help is just a few taps away.</li>
            <li>**Global Reach:** We aim to cover every corner of the world, making emergency assistance universally accessible.</li>
            <li>**Free Service:** Global EmergencyFinder is a completely free public service, funded through ethical advertisements to support our operational costs.</li>
        </ul>

        <p>For inquiries, partnerships, or to report outdated information, please don't hesitate to <a href="#contact-us-section" style="color: var(--primary); font-weight: 600;">contact us</a>.</p>
    </section>

    <!-- Contact Us Section (from contact.html) -->
    <section class="content-page" id="contact-us-section">
        <h2 class="section-title">Contact Us</h2>
        <p>We're here to help! Whether you have a question, feedback, or need to update information for an emergency service, please reach out to us using the methods below.</p>

        <div class="contact-info">
            <h3>General Inquiries</h3>
            <p><i class="fas fa-envelope"></i> Email: <a href="mailto:spreadinghappiness@gmail.com">spreadinghappiness@gmail.com</a></p>
            <p><i class="fas fa-phone-alt"></i> Phone: <a href="tel:0000000000">0000000000</a></p>

            <h3>Address</h3>
            <p><i class="fas fa-map-marker-alt"></i>GHAZIABAD<br>UTTAR PRADESH INDIA 201206</p>

            <h3>Service Listing Updates</h3>
            <p>If you represent an emergency service and need to list your organization or update existing information, please email us with "Service Update" in the subject line at <a href="mailto:spreadinghappiness@gmail.com">spreadinghappiness@gmail.com</a>.</p>

            <h3>Feedback & Suggestions</h3>
            <p>Your input helps us improve! Share your thoughts on how we can make Global EmergencyFinder even better by emailing us at <a href="mailto:spreadinghappiness@gmail.com">spreadinghappiness@gmail.com</a>.</p>
        </div>
    </section>

    <!-- Privacy Policy Section (from privacy.html) -->
    <section class="content-page" id="privacy-policy-section">
        <h2 class="section-title">Privacy Policy</h2>
        <p>At Global EmergencyFinder, your privacy is paramount. This policy outlines how we collect, use, and protect your information when you use our service.</p>

        <h3>Information We Collect</h3>
        <p>We collect very limited information, primarily to provide and improve our service:</p>
        <ul>
            <li>**Location Data:** When you use "Near Me" or the "SOS" button, we request access to your device's geolocation. This data is used in real-time to find nearby emergency services and determine your local emergency number. **We do not store your precise location data on our servers.** It's processed client-side (in your browser) and immediately discarded after the search/action is completed.</li>
            <li>**Non-Personal Usage Data:** We may collect anonymous, aggregated data about how the website is used (e.g., popular search categories, browser types). This helps us understand user behavior and improve the user experience. This data cannot be used to identify you personally.</li>
            <li>**Google AdSense:** As our service is free, we utilize Google AdSense for monetization. Google AdSense may collect data to serve relevant ads, in accordance with Google's own privacy policy.</li>
        </ul>

        <h3>How We Use Your Information</h3>
        <p>Your information is used solely for the following purposes:</p>
        <ul>
            <li>To provide accurate and localized emergency service search results.</li>
            <li>To enable the "Emergency SOS" feature by initiating calls and directions based on your detected location.</li>
            <li>To improve and optimize the performance and usability of the Global EmergencyFinder website.</li>
            <li>To display relevant advertisements through Google AdSense.</li>
        </ul>

        <h3>Data Sharing and Disclosure</h3>
        <p>We do not sell, trade, or otherwise transfer your personally identifiable information to outside parties. We may share non-personally identifiable, aggregated demographic information with our partners and advertisers for the purposes outlined above.</p>
        <p>We may also disclose your information when we believe release is appropriate to comply with the law, enforce our site policies, or protect ours or others' rights, property, or safety.</p>

        <h3>Third-Party Links</h3>
        <p>Our website contains links to third-party websites (e.g., official government emergency sites, WHO, IFRC, Google Maps). These third-party sites have separate and independent privacy policies. We therefore have no responsibility or liability for the content and activities of these linked sites.</p>

        <h3>Your Consent</h3>
        <p>By using our site, you consent to our privacy policy.</p>

        <h3>Changes to Our Privacy Policy</h3>
        <p>If we decide to change our privacy policy, we will post those changes on this page. This policy was last modified on July 11, 2025.</p>

        <h3>Contacting Us</h3>
        <p>If you have any questions regarding this privacy policy, you may contact us using the information provided on our <a href="#contact-us-section">Contact Us</a> page.</p>
    </section>

    <!-- Terms of Service Section (from terms.html) -->
    <section class="content-page" id="terms-of-service-section">
        <h2 class="section-title">Terms of Service</h2>
        <p>Welcome to Global EmergencyFinder! By accessing or using our website, you agree to comply with and be bound by the following terms and conditions of use. Please review these terms carefully.</p>

        <h3>1. Acceptance of Terms</h3>
        <p>By using the Global EmergencyFinder website, you agree to these Terms of Service. If you do not agree to these terms, you should not use this website.</p>

        <h3>2. Service Description</h3>
        <p>Global EmergencyFinder is a free online directory service designed to help users locate emergency and essential services (such as hospitals, police, fire, pharmacies, etc.) globally. All information provided is sourced from public data (e.g., OpenStreetMap) and is intended for informational purposes only. While we strive for accuracy, we cannot guarantee the completeness, reliability, or timeliness of all information.</p>

        <h3>3. Disclaimer of Emergency Use</h3>
        <p><strong>GLOBAL EMERGENCYFINDER IS NOT A SUBSTITUTE FOR DIRECTLY DIALING YOUR LOCAL EMERGENCY SERVICES. IN ANY LIFE-THREATENING SITUATION, ALWAYS DIAL YOUR COUNTRY'S OFFICIAL EMERGENCY NUMBER IMMEDIATELY.</strong></p>
        <p>The functionality to initiate calls or provide directions is offered for convenience and relies on your device's capabilities and network connectivity, which we cannot guarantee. We are not responsible for any delays, errors, or failures in contacting emergency services through this platform.</p>

        <h3>4. User Responsibilities</h3>
        <ul>
            <li>You agree to use this service responsibly and for its intended purpose.</li>
            <li>You acknowledge that all location-based features require your explicit consent to access your device's location.</li>
            <li>You understand that information provided is derived from third-party sources and should be verified independently when critical.</li>
            <li>You agree not to use the service for any unlawful or prohibited activities.</li>
        </ul>

        <h3>5. Intellectual Property</h3>
        <p>All content on this website, including text, graphics, logos, and images, is the property of Global EmergencyFinder or its content suppliers and protected by international copyright laws.</p>

        <h3>6. Limitation of Liability</h3>
        <p>Global EmergencyFinder shall not be liable for any direct, indirect, incidental, special, consequential, or exemplary damages, including but not limited to, damages for loss of profits, goodwill, data, or other intangible losses, resulting from the use or inability to use the service.</p>

        <h3>7. Changes to Terms</h3>
        <p>We reserve the right to modify these Terms of Service at any time. Your continued use of the website after any such changes constitutes your acceptance of the new Terms.</p>

        <h3>8. Governing Law</h3>
        <p>These terms shall be governed by and construed in accordance with the laws of [Your Country/State], without regard to its conflict of law principles.</p>

        <h3>9. Contact Information</h3>
        <p>For any questions regarding these Terms of Service, please contact us via our <a href="#contact-us-section">Contact Us</a> page.</p>
        <p>Last updated: July 11, 2025</p>
    </section>

    <script>
        // --- Configuration (YOUR GOOGLE MAPS PLATFORM API KEY) ---
        const Maps_API_KEY = "AIzaSyD92j3nHCEuY3u9Tb7ru-IbVtf5NOsITOk"; // Your Google Maps API Key
        // --- END Configuration ---

        // Mapping of country names to ISO 3166-1 alpha-2 codes for flags
        const countryToIsoCode = {
            "United States": "us",
            "United Kingdom": "gb",
            "Australia": "au",
            "India": "in",
            "Canada": "ca",
            "Japan": "jp",
            "Global (EU)": "eu"
        };

        // Global emergency numbers by country
        const globalEmergencyNumbers = [
            { country: "Global (EU)", number: "112", description: "General emergency number across the European Union", link: "https://ec.europa.eu/info/general-emergency-number-112_en" },
            { country: "United States", number: "911", description: "Emergency services for police, fire, and medical", link: "https://www.911.gov" },
            { country: "United Kingdom", number: "999", description: "Emergency services for police, fire, and ambulance", link: "https://www.gov.uk/emergency-services" },
            { country: "Australia", number: "000", description: "Emergency services for police, fire, and ambulance", link: "https://www.triplezero.gov.au" },
            { country: "India", number: "112", description: "Unified emergency response number", link: "https://www.india.gov.in/emergency-numbers" },
            { country: "Canada", number: "911", description: "Emergency services for police, fire, and medical", link: "https://www.canada.ca/en/services/policing/emergencies.html" },
            { country: "Japan", number: "119", description: "Emergency services for fire and ambulance", link: "https://www.japan-guide.com/e/e2022.html" },
            { country: "Global Crisis Hotline", number: "Varies", description: "Find local crisis hotlines via Befrienders Worldwide", link: "https://befrienders.org" }
        ];

        // Map Google Place Types to Font Awesome icons and display names
        const serviceCategoryMap = {
            // Google Places API types (often multiple per category). Keys are the 'type' attribute from Google Places.
            hospital: { icon: 'fas fa-hospital', className: 'hospital', displayName: 'Hospital' },
            fire_station: { icon: 'fas fa-fire-extinguisher', className: 'fire_station', displayName: 'Fire Department' },
            police: { icon: 'fas fa-handcuffs', className: 'police', displayName: 'Police Station' },
            pharmacy: { icon: 'fas fa-pills', className: 'pharmacy', displayName: 'Pharmacy' },
            veterinary_care: { icon: 'fas fa-paw', className: 'veterinary_clinic', displayName: 'Veterinary Clinic' }, // Google uses veterinary_care
            lodging: { icon: 'fas fa-home', className: 'shelter', displayName: 'Shelter' }, // General fallback for shelter
            community_center: { icon: 'fas fa-hand-holding-heart', className: 'community_center', displayName: 'Community Support' },
            // Custom type for hotlines (not a standard Google Place Type, handled via static data)
            crisis_hotline: { icon: 'fas fa-headset', className: 'crisis_hotline', displayName: 'Crisis Hotline' },
            // Fallback for types not explicitly mapped
            default: { icon: 'fas fa-info-circle', className: 'unknown', displayName: 'Service' }
        };


        // Cache for API results to prevent redundant calls
        const cache = new Map();
        let currentServices = []; // Stores the currently displayed services for modal details
        let lastKnownPosition = null; // Stores user's last known coordinates {latitude, longitude} for directions

        // Debounce timer for search input to limit API calls
        let searchDebounceTimer;

        // --- Utility Functions ---

        /**
         * Sanitizes input strings to prevent XSS attacks.
         * @param {string} input - The string to sanitize.
         * @returns {string} The sanitized string.
         */
        function sanitizeInput(input) {
            const div = document.createElement('div');
            div.textContent = input;
            return div.innerHTML;
        }

        /**
         * Generates HTML for a country flag based on its ISO code.
         * @param {string} countryName - The full name of the country.
         * @param {boolean} isQuickLink - True if the flag is for a quick link (smaller size).
         * @returns {string} HTML string for the flag image or a globe icon.
         */
        function getFlagHtml(countryName, isQuickLink = false) {
            const isoCode = countryToIsoCode[countryName];
            if (isoCode) {
                const size = isQuickLink ? 'w20' : 'w40'; // w20 or w40 for flagcdn.com
                return `<img src="https://flagcdn.com/${size}/${isoCode.toLowerCase()}.png" class="country-flag" alt="Flag of ${countryName}">`;
            } else if (countryName === "Global Crisis Hotline") {
                return '<i class="fas fa-globe country-flag globe-icon"></i>';
            }
            return '';
        }

        /**
         * Calculates the distance between two geographical coordinates (Haversine formula).
         * Not currently used for display but kept for potential future use.
         * @param {number} lat1 - Latitude of point 1.
         * @param {number} lon1 - Longitude of point 1.
         * @param {number} lat2 - Latitude of point 2.
         * @param {number} lon2 - Longitude of point 2.
         * @returns {number} Distance in kilometers.
         */
        function calculateDistance(lat1, lon1, lat2, lon2) {
            const R = 6371; // Radius of Earth in kilometers
            const dLat = (lat2 - lat1) * Math.PI / 180;
            const dLon = (lon2 - lon1) * Math.PI / 180;
            const a = Math.sin(dLat / 2) * Math.sin(dLat / 2) +
                      Math.cos(lat1 * Math.PI / 180) * Math.cos(lat2 * Math.PI / 180) *
                      Math.sin(dLon / 2) * Math.sin(dLon / 2);
            const c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1 - a));
            return R * c;
        }

        /**
         * Maps Google Places API types to a predefined service category for display.
         * @param {Array<string>} placeTypes - Array of Google Place types.
         * @returns {object} Object containing icon class, CSS class, and display name.
         */
        function getServiceCategoryInfo(placeTypes) {
            if (!placeTypes || !Array.isArray(placeTypes)) {
                return serviceCategoryMap.default;
            }
            // Prioritize specific emergency types first
            for (const key of ['hospital', 'fire_station', 'police', 'pharmacy', 'veterinary_care', 'shelter', 'community_center', 'crisis_hotline']) {
                if (placeTypes.includes(key) && serviceCategoryMap[key]) {
                    return serviceCategoryMap[key];
                }
            }
            // Fallback to general types if none of the specific emergency types match
            for (const type of placeTypes) {
                if (serviceCategoryMap[type]) {
                    return serviceCategoryMap[type];
                }
            }
            return serviceCategoryMap.default;
        }


        // --- Page Content Loaders ---

        /**
         * Dynamically loads and displays global emergency numbers in the designated grid.
         */
        function loadEmergencyNumbers() {
            const grid = document.getElementById('emergency-numbers-grid');
            if (!grid) return; // Exit if element not found

            grid.innerHTML = '';
            globalEmergencyNumbers.forEach(num => {
                const card = document.createElement('div');
                card.className = 'emergency-number-card';
                const flagHtml = getFlagHtml(num.country, false);
                card.innerHTML = `
                    <h4>${flagHtml} ${sanitizeInput(num.country)}</h4>
                    <p><strong>${sanitizeInput(num.number)}</strong>: ${sanitizeInput(num.description)}</p>
                    <a href="${sanitizeInput(num.link)}" target="_blank" class="category-link" aria-label="Learn more about ${num.country} emergency services">Learn More <i class="fas fa-external-link-alt"></i></a>
                `;
                grid.appendChild(card);
            });
        }

        /**
         * Loads dynamic emergency quick links based on user's current country or a default 'Global'.
         * Uses Google Geolocation API for country detection if API key is available.
         * @param {GeolocationPosition|null} position - Optional: GeolocationPosition object if location is known.
         */
        async function loadDynamicEmergencyLinks(position = null) {
            const linksContainer = document.getElementById('dynamic-emergency-links');
            if (!linksContainer) return; // Exit if element not found

            let country = 'Global';

            if (position) {
                try {
                    if (Maps_API_KEY && Maps_API_KEY !== "YOUR_GOOGLE_MAPS_API_KEY") {
                        // Use Google Geocoding API to get country from coordinates
                        const reverseGeoResponse = await fetch(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${position.coords.latitude},${position.coords.longitude}&key=${Maps_API_KEY}`);
                        const reverseGeoData = await reverseGeoResponse.json();
                        if (reverseGeoData.results && reverseGeoData.results.length > 0) {
                            const countryComponent = reverseGeoData.results[0].address_components.find(comp => comp.types.includes('country'));
                            country = countryComponent ? countryComponent.long_name : 'Global';
                        }
                    } else { // Fallback to Nominatim if no Google API Key
                        const response = await fetch(`https://nominatim.openstreetmap.org/reverse?lat=${position.coords.latitude}&lon=${position.coords.longitude}&format=json&zoom=3`, {
                            headers: { 'User-Agent': 'GlobalEmergencyFinder/1.0 (https://yourwebsite.com)' } // Required by Nominatim
                        });
                        if (!response.ok) throw new Error('Nominatim Geocoding failed');
                        const data = await response.json();
                        country = data.address?.country || 'Global';
                    }
                } catch (error) {
                    console.error('Error fetching country for dynamic links:', error);
                    country = 'Global'; // Default to Global on error
                }
            }

            linksContainer.innerHTML = '';
            // Filter for relevant numbers: country-specific or global generic ones
            const relevantNumbers = globalEmergencyNumbers.filter(num => num.country === country);
            const globalGenericNumbers = globalEmergencyNumbers.filter(num => num.country.includes('Global') && num.country !== country);
            // Use a Set to ensure uniqueness if a country happens to be 'Global' and also has a specific entry
            const numbersToDisplay = [...new Set([...relevantNumbers, ...globalGenericNumbers])];

            numbersToDisplay.forEach(num => {
                const link = document.createElement('a');
                link.href = num.number === 'Varies' ? num.link : `tel:${num.number}`;
                link.className = 'emergency-link';
                link.target = num.number === 'Varies' ? '_blank' : '_self'; // Open external links in new tab
                link.rel = num.number === 'Varies' ? 'noopener noreferrer' : ''; // Security for external links
                const flagHtml = getFlagHtml(num.country, true);
                link.innerHTML = `
                    ${flagHtml || `<i class="fas ${num.number === 'Varies' ? 'fa-globe' : 'fa-phone-alt'}"></i>`}
                    ${sanitizeInput(num.country)}: ${sanitizeInput(num.number === 'Varies' ? 'Find Crisis Hotline' : num.number)}
                `;
                link.setAttribute('aria-label', `Call ${num.country} emergency number ${num.number}`);
                linksContainer.appendChild(link);
            });
        }

        // --- Search Functionality (Uses Google Places API) ---

        /**
         * Main function to search for emergency services using Google Places API.
         * Handles text search and "Near Me" geolocation.
         * @param {object|null} searchCoords - Optional: {latitude, longitude} if search is based on direct geolocation.
         */
        async function searchServices(searchCoords = null) {
            // Basic API Key validation
            if (!Maps_API_KEY || Maps_API_KEY === "YOUR_GOOGLE_MAPS_API_KEY") {
                displayError("Google Maps API Key is missing or invalid. Please configure it in script.js for search functionality.");
                return;
            }

            const searchInputEl = document.getElementById('search-input');
            const categoryFilterEl = document.getElementById('category-filter');
            const searchButton = document.querySelector('.search-button');
            const locationButton = document.querySelector('.location-button');

            let originalPlaceholder = searchInputEl.placeholder;
            searchInputEl.placeholder = 'Searching...';

            // Disable buttons and show loading state
            searchButton.disabled = true;
            locationButton.disabled = true;

            const searchInput = sanitizeInput(searchInputEl.value.toLowerCase().trim());
            const categoryFilter = categoryFilterEl.value;
            const resultsListContainer = document.getElementById('results-list');
            const resultsCountEl = document.getElementById('results-count');

            // Mapping dropdown values to Google Places API types for search queries
            const placeTypeQueryMap = {
                hospital: 'hospital',
                fire_station: 'fire_station',
                police: 'police',
                pharmacy: 'pharmacy',
                veterinary_care: 'veterinary_care',
                shelter: 'lodging', // No direct 'shelter' type, lodging is a general fallback
                community_center: 'community_center',
                crisis_hotline: 'counseling_center', // Closest Google Places type for crisis hotlines
                all: '' // For 'all', we'll use a broad text search or multiple specific types
            };

            resultsListContainer.innerHTML = `<div class="loading-spinner"></div>`;
            resultsCountEl.textContent = `Searching...`;

            let queryLat = null;
            let queryLon = null;
            let locationName = searchInput;
            let queryText = searchInput; // The text to send to Google Places Text Search

            try {
                // 1. Determine location (coordinates) for the search
                if (searchCoords) {
                    // Direct coordinates provided (e.g., from getLocation())
                    queryLat = searchCoords.latitude;
                    queryLon = searchCoords.longitude;
                    lastKnownPosition = searchCoords; // Update last known position
                    
                    // Reverse geocode to get a user-friendly location name
                    const geoResponse = await fetch(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${queryLat},${queryLon}&key=${Maps_API_KEY}`);
                    const geoData = await geoResponse.json();
                    if (geoData.results && geoData.results.length > 0) {
                        locationName = geoData.results[0].address_components.find(comp => comp.types.includes('locality'))?.long_name ||
                                       geoData.results[0].address_components.find(comp => comp.types.includes('administrative_area_level_1'))?.long_name ||
                                       geoData.results[0].address_components.find(comp => comp.types.includes('country'))?.long_name ||
                                       'Your current location';
                        searchInputEl.value = `Near ${locationName}`; // Update search input field
                    } else {
                        locationName = 'Your current location';
                        searchInputEl.value = 'Near Me';
                    }
                    loadDynamicEmergencyLinks({ coords: { latitude: queryLat, longitude: queryLon } }); // Update quick links
                } else if (searchInput.includes('near me') && navigator.geolocation) {
                    // User explicitly requested "Near Me" via text input
                    resultsCountEl.textContent = `Getting your precise location...`;
                    const position = await new Promise((resolve, reject) => {
                        navigator.geolocation.getCurrentPosition(resolve, reject, { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 });
                    });
                    queryLat = position.coords.latitude;
                    queryLon = position.coords.longitude;
                    lastKnownPosition = { latitude: queryLat, longitude: queryLon }; // Update last known position
                    
                    // Reverse geocode to get a user-friendly location name
                    const geoResponse = await fetch(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${queryLat},${queryLon}&key=${Maps_API_KEY}`);
                    const geoData = await geoResponse.json();
                    if (geoData.results && geoData.results.length > 0) {
                        locationName = geoData.results[0].address_components.find(comp => comp.types.includes('locality'))?.long_name ||
                                       geoData.results[0].address_components.find(comp => comp.types.includes('administrative_area_level_1'))?.long_name ||
                                       geoData.results[0].address_components.find(comp => comp.types.includes('country'))?.long_name ||
                                       'Your current location';
                        searchInputEl.value = `Near ${locationName}`; // Update search input field
                    } else {
                         locationName = 'Your current location';
                         searchInputEl.value = 'Near Me';
                    }
                    loadDynamicEmergencyLinks(position); // Update quick links
                } else if (searchInput) {
                    // User provided a text search input (e.g., "hospital in London")
                    resultsCountEl.textContent = `Searching for "${searchInput}"...`;
                    const geoResponse = await fetch(`https://maps.googleapis.com/maps/api/geocode/json?address=${encodeURIComponent(searchInput)}&key=${Maps_API_KEY}`);
                    const geoData = await geoResponse.json();
                    if (geoData.results && geoData.results.length > 0 && geoData.results[0].geometry) {
                        queryLat = geoData.results[0].geometry.location.lat;
                        queryLon = geoData.results[0].geometry.location.lng;
                        locationName = geoData.results[0].formatted_address;
                        lastKnownPosition = { latitude: queryLat, longitude: queryLon }; // Update last known position
                    } else {
                        displayError(`Could not find a valid location for "${searchInput}". Please try a different query.`);
                        searchInputEl.placeholder = originalPlaceholder;
                        searchButton.disabled = false;
                        locationButton.disabled = false;
                        return;
                    }
                } else {
                    // No input and no "Near Me" request
                    displayError('Please enter a location (e.g., "London", "hospital in Paris") or use "Near Me" to find services.');
                    resultsCountEl.textContent = 'Awaiting search input...';
                    searchInputEl.placeholder = originalPlaceholder;
                    searchButton.disabled = false;
                    locationButton.disabled = false;
                    return;
                }

                // Check cache before making API call
                const cacheKey = `${queryLat},${queryLon}_${categoryFilter}_${queryText}`;
                if (cache.has(cacheKey)) {
                    currentServices = cache.get(cacheKey);
                    displayResults(currentServices, resultsListContainer, resultsCountEl, locationName);
                    searchInputEl.placeholder = originalPlaceholder;
                    searchButton.disabled = false;
                    locationButton.disabled = false;
                    return;
                }

                // 2. Perform Google Places Search
                let placesApiUrl = `https://maps.googleapis.com/maps/api/place/nearbysearch/json?key=${Maps_API_KEY}`;
                let queryParams = `location=${queryLat},${queryLon}&radius=10000`; // Search within 10km radius by default

                let googlePlacesType = '';
                if (categoryFilter && categoryFilter !== 'all' && placeTypeQueryMap[categoryFilter]) {
                    googlePlacesType = placeTypeQueryMap[categoryFilter];
                    queryParams += `&type=${googlePlacesType}`;
                } else if (queryText && queryText !== 'near me') {
                    // If a text query is provided and no specific category, use textsearch
                    placesApiUrl = `https://maps.googleapis.com/maps/api/place/textsearch/json?key=${Maps_API_KEY}`;
                    queryParams = `query=${encodeURIComponent(queryText + ' emergency service')}&location=${queryLat},${queryLon}&radius=10000`;
                } else {
                     // If no specific category or text, search for common emergency types
                     queryParams += `&type=hospital|fire_station|police|pharmacy|veterinary_care|lodging|community_center|counseling_center`;
                }
                
                const placesResponse = await fetch(`${placesApiUrl}&${queryParams}`);
                const placesData = await placesResponse.json();

                if (placesData.status !== 'OK' && placesData.status !== 'ZERO_RESULTS') {
                    // Handle specific Google Places API errors
                    let apiErrorMessage = `Google Places API error: ${placesData.status}.`;
                    if (placesData.error_message) {
                        apiErrorMessage += ` ${placesData.error_message}`;
                    }
                    if (placesData.status === 'OVER_QUERY_LIMIT') {
                        apiErrorMessage += " You may have exceeded your API quota or billing is not enabled.";
                    } else if (placesData.status === 'REQUEST_DENIED') {
                        apiErrorMessage += " Ensure your API key is correct and has proper restrictions configured.";
                    }
                    throw new Error(apiErrorMessage);
                }

                let services = placesData.results.map(place => {
                    const categoryInfo = getServiceCategoryInfo(place.types);
                    const photoReference = place.photos && place.photos.length > 0 ? place.photos[0].photo_reference : null;
                    const photoUrl = photoReference ? `https://maps.googleapis.com/maps/api/place/photo?maxwidth=400&photoreference=${photoReference}&key=${Maps_API_KEY}` : null;
                    
                    const formattedAddress = place.formatted_address || place.vicinity || 'Address not available';
                    const phone = place.international_phone_number || place.formatted_phone_number || 'N/A';
                    const website = place.website || '';
                    
                    let hoursText = 'Hours not available';
                    if (place.opening_hours) {
                        if (place.opening_hours.open_now) {
                            hoursText = 'Open Now';
                        } else if (place.opening_hours.weekday_text) {
                            hoursText = place.opening_hours.weekday_text.join('; ');
                        }
                    }

                    return {
                        id: place.place_id,
                        name: place.name,
                        category: categoryInfo.className,
                        location: formattedAddress,
                        phone: phone,
                        website: website,
                        hours: hoursText,
                        description: place.editorial_summary?.overview || `A local ${categoryInfo.displayName} service.`,
                        lat: place.geometry.location.lat,
                        lon: place.geometry.location.lng,
                        photoUrl: photoUrl,
                        googlePlaceId: place.place_id
                    };
                });

                if (categoryFilter === 'crisis_hotline' || categoryFilter === 'all') {
                    const hotlineServices = globalEmergencyNumbers
                        .filter(num => num.description.includes('crisis') || num.description.includes('hotline'))
                        .map((num, index) => ({
                            id: `static-hotline-${index}`, // Unique ID for static entries
                            name: num.description,
                            category: 'crisis_hotline',
                            location: num.country,
                            phone: num.number,
                            website: num.link,
                            distance: '', // Static entries don't have a distance
                            hours: '24/7',
                            description: `A ${num.country} crisis hotline. Please check the 'Learn More' link for specific numbers if 'Varies'.`,
                            lat: null, // No specific lat/lon for static hotlines
                            lon: null,
                            learnMoreLink: num.link, // Used for the "Learn More" button in modal
                            photoUrl: null
                        }));
                    services.push(...hotlineServices);
                }

                currentServices = services; // Update global variable with fetched services
                cache.set(cacheKey, services); // Cache the results

                displayResults(services, resultsListContainer, resultsCountEl, locationName);

            } catch (error) {
                console.error('Error fetching services:', error);
                let errorMessage = `Failed to load services. ${error.message}.`;
                if (error.name === 'TypeError' && error.message === 'Failed to fetch') {
                    errorMessage = "Connection issue: Failed to reach Google Maps services. Please check your internet connection, API key referrers in Google Cloud Console, or temporarily disable browser extensions (e.g., ad blockers).";
                } else if (error.code === GeolocationPositionError.PERMISSION_DENIED) {
                    errorMessage = "Geolocation access denied. Please enable location services in your browser settings or enter a location manually.";
                } else if (error.code === GeolocationPositionError.TIMEOUT) {
                    errorMessage = "Location request timed out. Your location could not be determined. Please try again or ensure strong GPS signal.";
                } else if (error.code === GeolocationPositionError.POSITION_UNAVAILABLE) {
                    errorMessage = "Location information is unavailable. Your device may not support it or has issues.";
                }
                displayError(`${errorMessage} Check our <a href="#emergency-numbers-section" style="color: var(--primary); font-weight: 600;">Global Emergency Numbers</a> for general help.`);
            } finally {
                // Re-enable buttons and reset placeholder regardless of success or failure
                searchInputEl.placeholder = originalPlaceholder;
                searchButton.disabled = false;
                locationButton.disabled = false;
            }
        }

        /**
         * Displays the search results in the UI.
         * @param {Array<object>} services - Array of service objects to display.
         * @param {HTMLElement} resultsListContainer - The container to append results to.
         * @param {HTMLElement} resultsCountEl - The element to display the results count.
         * @param {string} locationName - The name of the location used for search.
         */
        function displayResults(services, resultsListContainer, resultsCountEl, locationName) {
            resultsListContainer.innerHTML = ''; // Clear previous results
            resultsCountEl.textContent = `${services.length} services found for "${locationName}"`;

            if (services.length === 0) {
                resultsListContainer.innerHTML = `
                    <div class="no-results-message">
                        <p>No services found matching your search. Try a different location or service type.</p>
                        <p>For immediate help, check our <a href="#emergency-numbers-section" style="color: var(--primary); font-weight: 600;">Global Emergency Numbers</a> or try our <a href="#categories-section" style="color: var(--primary); font-weight: 600;">service categories</a>.</p>
                    </div>
                `;
                return;
            }

            services.forEach(service => {
                const resultItem = document.createElement('div');
                resultItem.className = 'result-item';
                resultItem.onclick = () => showServiceDetails(service.id); // Open modal on click
                resultItem.setAttribute('tabindex', '0'); // Make div focusable
                resultItem.setAttribute('role', 'button'); // Indicate it's a clickable element
                resultItem.setAttribute('aria-label', `View details for ${service.name}`);

                const categoryInfo = getServiceCategoryInfo([service.category]); // Get display info for category
                const iconClass = categoryInfo.icon;

                resultItem.innerHTML = `
                    <h3><i class="${iconClass} service-icon"></i>${sanitizeInput(service.name)}</h3>
                    <div class="result-meta">
                        <span class="result-category ${service.category}">
                            ${sanitizeInput(categoryInfo.displayName)}
                        </span>
                        <span class="result-location">
                            <i class="fas fa-map-marker-alt"></i> ${sanitizeInput(service.location)}
                        </span>
                        <span><i class="fas fa-phone-alt"></i> Phone: ${sanitizeInput(service.phone)}</span>
                        ${service.distance ? `<span><i class="fas fa-route"></i> ${sanitizeInput(service.distance)}</span>` : ''}
                        <span><i class="far fa-clock"></i> ${sanitizeInput(service.hours)}</span>
                    </div>
                    <p>${sanitizeInput(service.description)}</p>
                `;
                resultsListContainer.appendChild(resultItem);
            });
        }

        /**
         * Displays an error message in the search results area.
         * @param {string} message - The error message to display.
         */
        function displayError(message) {
            const resultsListContainer = document.getElementById('results-list');
            const resultsCountEl = document.getElementById('results-count');
            if (resultsListContainer) {
                resultsListContainer.innerHTML = `
                    <div class="no-results-message" style="color: var(--danger); border-color: var(--danger);">
                        <p><i class="fas fa-exclamation-triangle"></i> ${message}</p>
                    </div>
                `;
            }
            if (resultsCountEl) {
                resultsCountEl.textContent = `Error occurred`;
            }
        }

        /**
         * Filters the search results by a specific category and triggers a new search.
         * @param {string} category - The category to filter by (e.g., 'hospital').
         */
        function filterCategory(category) {
            const categoryFilterEl = document.getElementById('category-filter');
            if (categoryFilterEl) {
                categoryFilterEl.value = category;
            }
            searchServices();
            // Smooth scroll to the search section
            const searchSection = document.getElementById('search-section');
            if (searchSection) {
                window.scrollTo({ top: searchSection.offsetTop - 100, behavior: 'smooth' });
            }
        }

        /**
         * Initiates the process of getting the user's current location and then searching services.
         */
        function getLocation() {
            const searchInputEl = document.getElementById('search-input');
            if (searchInputEl) {
                searchInputEl.value = 'Locating...';
            }

            if (navigator.geolocation) {
                navigator.geolocation.getCurrentPosition(
                    (position) => {
                        searchServices({ latitude: position.coords.latitude, longitude: position.coords.longitude });
                    },
                    (error) => {
                        console.error('Error getting location:', error);
                        if (searchInputEl) {
                            searchInputEl.value = '';
                        }
                        let errorMessage = "Unable to determine your precise location.";
                        if (error.code === GeolocationPositionError.PERMISSION_DENIED) {
                            errorMessage = "Location access denied. Please enable it in your browser settings.";
                        } else if (error.code === GeolocationPositionError.TIMEOUT) {
                            errorMessage = "Location request timed out. Your location could not be determined. Please try again or ensure strong GPS signal.";
                        } else if (error.code === GeolocationPositionError.POSITION_UNAVAILABLE) {
                            errorMessage = "Location information is unavailable. Your device may not support it or has issues.";
                        }
                        alert(`${errorMessage} Please enter your city or country manually.`);
                        displayError(`Geolocation failed: ${errorMessage} Please enter a location manually.`);
                    },
                    { enableHighAccuracy: true, timeout: 10000, maximumAge: 0 } // High accuracy, 10s timeout, no cached position
                );
            } else {
                alert('Geolocation is not supported by this browser. Please enter your location manually.'); // Fallback alert
                if (searchInputEl) {
                    searchInputEl.value = '';
                }
                displayError('Geolocation not supported by your browser. Please enter a location manually.');
            }
        }

        // --- Service Details Modal Functions ---

        /**
         * Displays a modal with detailed information about a selected service.
         * @param {string} id - The ID of the service to display details for.
         */
        function showServiceDetails(id) {
            const service = currentServices.find(s => s.id === id);
            if (!service) {
                alert('Service details not available.'); // Use alert as per previous pattern, but custom modal is preferred for premium UI
                return;
            }

            const modal = document.getElementById('service-details-modal');
            const categoryInfo = getServiceCategoryInfo([service.category]); // Get display info for category
            const iconClass = categoryInfo.icon;

            // Populate modal content
            document.getElementById('modal-service-name').innerHTML = `<i class="${iconClass} service-icon"></i>${sanitizeInput(service.name)}`;
            document.getElementById('modal-service-category').textContent = sanitizeInput(categoryInfo.displayName);
            document.getElementById('modal-service-category').className = `result-category ${service.category}`; // Apply category-specific CSS class
            document.getElementById('modal-service-location').innerHTML = `<i class="fas fa-map-marker-alt"></i> ${sanitizeInput(service.location)}`;
            document.getElementById('modal-service-phone').innerHTML = `<i class="fas fa-phone-alt"></i> ${sanitizeInput(service.phone)}`;
            document.getElementById('modal-service-hours').innerHTML = `<i class="far fa-clock"></i> ${sanitizeInput(service.hours)}`;
            document.getElementById('modal-service-description').textContent = sanitizeInput(service.description);

            // Handle website link visibility
            const websiteSpan = document.getElementById('modal-service-website');
            const websiteLink = websiteSpan.querySelector('a');
            if (service.website && service.website !== 'N/A') {
                let displayUrl = service.website;
                if (!displayUrl.startsWith('http://') && !displayUrl.startsWith('https://')) {
                    displayUrl = 'http://' + displayUrl; // Prepend http for valid URL if missing
                }
                websiteLink.href = displayUrl;
                try {
                    websiteLink.textContent = new URL(displayUrl).hostname; // Display only hostname
                } catch (e) {
                    websiteLink.textContent = service.website; // Fallback to full URL if URL parsing fails
                }
                websiteSpan.style.display = 'flex';
            } else {
                websiteSpan.style.display = 'none';
            }

            // Handle photo display in modal
            const modalPhotoSpan = document.getElementById('modal-service-photo');
            const modalPhotoImg = modalPhotoSpan.querySelector('img');
            if (service.photoUrl) {
                modalPhotoImg.src = service.photoUrl;
                modalPhotoSpan.style.display = 'block';
                modalPhotoImg.onload = () => modalPhotoSpan.classList.remove('loading'); // Remove loading class on load
                modalPhotoImg.onerror = () => {
                    modalPhotoSpan.style.display = 'none'; // Hide if image fails to load
                    console.error("Failed to load image:", service.photoUrl);
                };
                modalPhotoSpan.classList.add('loading'); // Add loading class before image starts loading
            } else {
                modalPhotoSpan.style.display = 'none';
                modalPhotoImg.src = ''; // Clear previous image
            }

            // Set call button href
            document.getElementById('modal-call-button').href = `tel:${sanitizeInput(service.phone)}`;

            // Handle directions button visibility and href
            const directionsButton = document.getElementById('modal-directions-button');
            if (service.lat && service.lon && lastKnownPosition) {
                // Directions from user's last known position to service location
                directionsButton.href = `https://www.google.com/maps/dir/?api=1&origin=${lastKnownPosition.latitude},${lastKnownPosition.longitude}&destination=${service.lat},${service.lon}&travelmode=driving`;
                directionsButton.style.display = 'flex';
            } else if (service.lat && service.lon) {
                // Search for service location if user's location is unknown
                directionsButton.href = `https://www.google.com/maps/search/?api=1&query=${service.lat},${service.lon}`;
                directionsButton.style.display = 'flex';
            }
            else {
                directionsButton.style.display = 'none'; // Hide if no location data
            }

            // Handle specific "Learn More" link for crisis hotlines
            const hotlineLink = document.getElementById('modal-hotline-link');
            const modalCallButton = document.getElementById('modal-call-button');
            if (service.category === 'crisis_hotline' && service.learnMoreLink) {
                hotlineLink.href = service.learnMoreLink;
                hotlineLink.target = '_blank';
                hotlineLink.rel = 'noopener noreferrer';
                hotlineLink.style.display = 'flex';
                // For hotlines, the "Call" button might become "Visit Page"
                modalCallButton.textContent = 'Visit Page';
                modalCallButton.href = service.learnMoreLink;
                modalCallButton.target = '_blank';
                modalCallButton.rel = 'noopener noreferrer';
            } else {
                hotlineLink.style.display = 'none';
                modalCallButton.textContent = 'Call';
                modalCallButton.target = '_self';
                modalCallButton.rel = '';
            }

            modal.classList.add('active'); // Show the modal
        }

        /**
         * Closes the service details modal.
         */
        function closeModal() {
            const modal = document.getElementById('service-details-modal');
            if (modal) {
                modal.classList.remove('active');
            }
        }

        // Close modal when clicking outside of it
        window.onclick = function(event) {
            const modal = document.getElementById('service-details-modal');
            if (event.target == modal) {
                closeModal();
            }
        }

        // --- EMERGENCY SOS BUTTON LOGIC ---
        /**
         * Triggers an emergency SOS action: attempts to call local emergency number
         * and open directions to the nearest hospital.
         */
        async function triggerEmergencySOS() {
            // Using confirm() as per previous implementation, but a custom modal is recommended for better UI control.
            const userConfirmed = confirm("Are you sure you want to trigger an emergency SOS? This will attempt to call your local emergency number and open directions to the nearest hospital.");

            if (!userConfirmed) {
                return;
            }

            let userLat = null;
            let userLon = null;
            let userCountry = 'Unknown';
            let emergencyNumber = '112'; // Default to EU emergency number

            try {
                if (!Maps_API_KEY || Maps_API_KEY === "YOUR_GOOGLE_MAPS_API_KEY") {
                    throw new Error("Google Maps API Key is missing for premium geolocation and places search. Falling back to browser's geolocation.");
                }

                // Try Google Geolocation API first for higher accuracy (IP-based)
                try {
                    const geoApiUrl = `https://www.googleapis.com/geolocation/v1/geolocate?key=${Maps_API_KEY}`;
                    const geoApiResponse = await fetch(geoApiUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ considerIp: true }) // Use IP address for geolocation
                    });
                    const geoApiData = await geoApiResponse.json();
                    if (geoApiData && geoApiData.location) {
                        userLat = geoApiData.location.lat;
                        userLon = geoApiData.location.lng;
                    } else {
                        throw new Error("Google Geolocation API did not return a location. Falling back to browser's geolocation.");
                    }
                } catch (apiError) {
                    console.warn("Google Geolocation API failed, falling back to browser geolocation:", apiError);
                    // Fallback to browser's Geolocation API
                    if (!navigator.geolocation) {
                        throw new Error("Browser geolocation not supported.");
                    }
                    const position = await new Promise((resolve, reject) => {
                        navigator.geolocation.getCurrentPosition(resolve, reject, { enableHighAccuracy: true, timeout: 15000, maximumAge: 0 });
                    });
                    userLat = position.coords.latitude;
                    userLon = position.coords.longitude;
                }

                lastKnownPosition = { latitude: userLat, longitude: userLon }; // Store for directions

                // Reverse geocode to get country using Google Geocoding API
                const reverseGeoResponse = await fetch(`https://maps.googleapis.com/maps/api/geocode/json?latlng=${userLat},${userLon}&key=${Maps_API_KEY}`);
                const reverseGeoData = await reverseGeoResponse.json();
                if (reverseGeoData.results && reverseGeoData.results.length > 0) {
                    const countryComponent = reverseGeoData.results[0].address_components.find(comp => comp.types.includes('country'));
                    userCountry = countryComponent ? countryComponent.long_name : 'Unknown';
                }

                // Determine emergency number based on country
                const countryEmergency = globalEmergencyNumbers.find(num => num.country === userCountry);
                if (countryEmergency && countryEmergency.number !== 'Varies') {
                    emergencyNumber = countryEmergency.number;
                } else if (userCountry === 'United States' || userCountry === 'Canada') {
                    emergencyNumber = '911'; // Common North American emergency number
                } else {
                    emergencyNumber = '112'; // Default to 112 for most of the world
                }

                // Attempt to make a call
                window.location.href = `tel:${emergencyNumber}`;
                alert(`Attempting to call emergency number: ${emergencyNumber} in ${userCountry}.`);

                // Find nearest hospital and open directions in a new tab
                findNearestServiceAndRedirect(userLat, userLon, 'hospital');

            } catch (error) {
                console.error('SOS Function Error:', error);
                let errorMessage = "Could not determine your location or a specific emergency number. Please dial your local emergency number directly.";
                if (error.code === GeolocationPositionError.PERMISSION_DENIED) {
                    errorMessage = "Location access denied for SOS. Please enable it in browser settings and try again, or dial directly.";
                } else if (error.code === GeolocationPositionError.TIMEOUT) {
                    errorMessage = "Location for SOS timed out. Please try again or dial directly.";
                }
                alert(`Emergency SOS failed: ${errorMessage} Defaulting to 112. Please be prepared to provide your location manually.`);
                window.location.href = `tel:112`; // Fallback to 112 even on failure
            }
        }

        /**
         * Finds the nearest service of a given type and redirects to Google Maps for directions.
         * @param {number} lat - User's current latitude.
         * @param {number} lon - User's current longitude.
         * @param {string} serviceType - The type of service to search for (e.g., 'hospital').
         */
        async function findNearestServiceAndRedirect(lat, lon, serviceType) {
            if (!Maps_API_KEY || Maps_API_KEY === "YOUR_GOOGLE_MAPS_API_KEY") {
                alert("Google Maps API Key is missing for directions. Please configure it in script.js.");
                return;
            }

            try {
                const placeType = serviceType === 'hospital' ? 'hospital' : 'point_of_interest'; // Default to point_of_interest if not hospital
                const placesApiUrl = `https://maps.googleapis.com/maps/api/place/nearbysearch/json?location=${lat},${lon}&radius=10000&type=${placeType}&key=${Maps_API_KEY}`;

                const placesResponse = await fetch(placesApiUrl);
                const placesData = await placesResponse.json();

                if (placesData.status === 'OK' && placesData.results.length > 0) {
                    const nearestService = placesData.results[0]; // Get the first (nearest) result

                    const directionsUrl = `https://www.google.com/maps/dir/?api=1&origin=${lat},${lon}&destination=${nearestService.geometry.location.lat},${nearestService.geometry.location.lng}&travelmode=driving`;
                    window.open(directionsUrl, '_blank'); // Open directions in a new tab
                    alert(`Opening directions to nearest ${nearestService.name} on Google Maps.`);
                } else {
                    console.warn(`No ${serviceType} found near current location for directions.`);
                    alert(`Could not find a nearby ${serviceType} to provide directions. Please refer to your call.`);
                }
            } catch (error) {
                console.error(`Error finding nearest ${serviceType} for directions:`, error);
                alert(`Failed to get directions to nearest ${serviceType}. Please use your mapping app manually.`);
            }
        }


        // --- Initialization ---
        document.addEventListener('DOMContentLoaded', () => {
            // Load dynamic content sections
            loadEmergencyNumbers();
            loadDynamicEmergencyLinks();

            // Set initial state for search results area
            const resultsList = document.getElementById('results-list');
            const resultsCount = document.getElementById('results-count');
            if (resultsList) {
                resultsList.innerHTML = `
                    <div class="no-results-message">
                        <p>Enter a location (e.g., "London", "hospital in Paris") or use "Near Me" to find emergency services.</p>
                    </div>
                `;
            }
            if (resultsCount) {
                resultsCount.textContent = 'Awaiting search input...';
            }

            // Initialize Google AdSense (if present)
            try {
                (adsbygoogle = window.adsbygoogle || []).push({});
            } catch (e) {
                console.error('AdSense initialization failed:', e);
            }

            // Smooth scrolling for anchor links
            document.querySelectorAll('a[href^="#"]').forEach(anchor => {
                anchor.addEventListener('click', function(e) {
                    e.preventDefault();
                    const targetId = this.getAttribute('href');
                    const target = document.querySelector(targetId);
                    if (target) {
                        window.scrollTo({
                            top: target.offsetTop - 80, // Adjust for fixed header height
                            behavior: 'smooth'
                        });
                    }
                });
            });

            // Handle initial hash in URL (for direct links to sections)
            if (window.location.hash) {
                const initialHashTarget = document.querySelector(window.location.hash);
                if (initialHashTarget) {
                    setTimeout(() => { // Small delay to allow page to render
                        window.scrollTo({
                            top: initialHashTarget.offsetTop - 80,
                            behavior: 'smooth'
                        });
                    }, 100);
                }
            }

            // Event listener for search input (with debounce)
            const searchInputEl = document.getElementById('search-input');
            if (searchInputEl) {
                searchInputEl.addEventListener('keyup', (e) => {
                    clearTimeout(searchDebounceTimer); // Clear previous timer
                    searchDebounceTimer = setTimeout(() => {
                        if (e.key === 'Enter') {
                            // If Enter is pressed, search immediately without debounce delay
                            searchServices();
                        } else if (searchInputEl.value.trim().length > 2 || searchInputEl.value.trim() === '') {
                            // Search if input is long enough or cleared
                            searchServices();
                        }
                    }, 500); // 500ms debounce delay
                });
            }

            // Event listener for category filter change
            const categoryFilterEl = document.getElementById('category-filter');
            if (categoryFilterEl) {
                categoryFilterEl.addEventListener('change', () => {
                    searchServices();
                });
            }

            // Keyboard accessibility for buttons
            document.querySelectorAll('.search-button, .location-button').forEach(button => {
                button.addEventListener('keypress', (e) => {
                    if (e.key === 'Enter' || e.key === ' ') {
                        e.preventDefault(); // Prevent default space/enter behavior
                        button.click(); // Trigger button click
                    }
                });
            });

            // Initial call to load dynamic links and potentially search if 'Near Me' is default
            // (This is handled by the DOMContentLoaded and initial search input logic)
        });
    </script>
</body>
</html>
